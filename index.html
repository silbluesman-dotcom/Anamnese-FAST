<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Anamnese Fast - Silvestre Azevedo</title>
<style>
  /* Bot√£o flutuante */
  #btn-scores-flutuante {
    position: fixed;
    right: 20px;
    top: 50%;
    transform: translateY(-50%);
    z-index: 9999;
    background-color: #1976d2;
    color: #fff;
    border: none;
    border-radius: 999px;
    padding: 12px 20px;
    font-size: 16px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    cursor: pointer;
  }

  #btn-scores-flutuante:hover {
    background-color: #0d47a1;
  }

  /* Fundo escuro atr√°s do modal */
  #modal-scores-backdrop {
    display: none;
    position: fixed;
    inset: 0;
    background-color: rgba(0,0,0,0.5);
    z-index: 9998;
  }

  /* Caixa do modal */
  #modal-scores {
    position: fixed;
    right: 80px;
    top: 50%;
    transform: translateY(-50%);
    width: 400px;
    max-height: 85vh;
    background-color: #ffffff;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    padding: 16px;
    overflow-y: auto;
    z-index: 10000;
    display: none;
  }

  #modal-scores h2 {
    margin-top: 0;
    font-size: 18px;
    margin-bottom: 8px;
  }

  #modal-scores .fechar {
    float: right;
    cursor: pointer;
    font-weight: bold;
  }

  #modal-scores section {
    border-top: 1px solid #eee;
    padding-top: 8px;
    margin-top: 8px;
  }

  #modal-scores section:first-of-type {
    border-top: none;
    padding-top: 0;
    margin-top: 0;
  }

  #modal-scores label {
    display: block;
    font-size: 13px;
    margin-bottom: 4px;
  }

  #modal-scores button {
    margin-top: 6px;
    margin-bottom: 4px;
  }

  #modal-scores p {
    font-size: 13px;
  }
</style>

  <style>
    :root{
      --primary:#00695c;
      --light:#b2dfdb;
      --bg:#f5f7fa;
      --white:#ffffff;
      --alert:#d32f2f;
      --text:#333;
      --gray1:#616161;
      --gray2:#424242;
      --pdf:#0d47a1;
      --input-bg:#fafafa;
      --border:#ccc;
      --shadow:rgba(0,0,0,0.08);
    }

    /* Dark Mode */
    body.dark-mode{
      --bg:#1a1a1a;
      --white:#2d2d2d;
      --text:#e0e0e0;
      --input-bg:#3a3a3a;
      --border:#555;
      --shadow:rgba(0,0,0,0.3);
      --light:#004d40;
    }

    body.dark-mode .author{
      color:#aaa;
    }

    body.dark-mode .input-label{
      color:#bbb;
    }

    body.dark-mode .label-bold{
      color:#e0e0e0;
    }

    body.dark-mode .toggle-btn{
      background:#404040;
      border-color:#555;
      color:#e0e0e0;
    }

    body.dark-mode .toggle-btn:hover{
      background:#4a4a4a;
    }

    body.dark-mode .toggle-btn.active{
      background:var(--primary);
      color:white;
    }

    body.dark-mode .modal-content,
    body.dark-mode .modal-historico-content,
    body.dark-mode #modal-scores{
      background:#2d2d2d;
      color:#e0e0e0;
    }

    body.dark-mode .paciente-item{
      background:#3a3a3a;
      color:#e0e0e0;
    }

    body.dark-mode .paciente-item:hover{
      background:#404040;
    }

    body.dark-mode #finalReport{
      background:#3a3a3a;
      color:#e0e0e0;
      border-color:#555;
    }
    body{
      font-family:"Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background:var(--bg);
      margin:0;
      padding:20px;
      color:var(--text);
    }
    .container{
      max-width:900px;
      margin:auto;
      background:var(--white);
      padding:30px;
      border-radius:12px;
      box-shadow:0 4px 15px rgba(0,0,0,0.08);
      position:relative;
    }

    .header{
      text-align:center;
      margin-bottom:30px;
      border-bottom:2px solid var(--light);
      padding-bottom:20px;
    }
    .header h1{
      color:var(--primary);
      margin:0;
      font-size:2rem;
      text-transform:uppercase;
      letter-spacing:1px;
    }
    .author{
      color:#666;
      font-size:0.9rem;
      letter-spacing:1px;
      font-weight:600;
    }
    .profile-pic{
      width:80px;
      height:80px;
      border-radius:50%;
      border:3px solid var(--primary);
      margin-top:15px;
      object-fit:cover;
      box-shadow:0 4px 6px rgba(0,0,0,0.1);
    }

    .section-title{
      background:var(--primary);
      color:white;
      padding:10px 15px;
      border-radius:6px;
      margin-top:30px;
      margin-bottom:15px;
      font-weight:900;
      text-transform:uppercase;
      font-size:0.95rem;
    }

    .row{
      display:flex;
      gap:15px;
      flex-wrap:wrap;
      margin-bottom:15px;
    }
    .col{
      flex:1;
      min-width:200px;
    }

    .input-label{
      display:block;
      font-size:0.85rem;
      font-weight:800;
      color:#555;
      margin-bottom:5px;
    }
    .label-bold{
      font-weight:900;
      color:#111;
    }
    .label-alert{
      font-weight:900;
      color:var(--alert);
    }

    .input-field, select, textarea{
      width:100%;
      padding:10px;
      border:1px solid var(--border);
      border-radius:6px;
      box-sizing:border-box;
      font-family:inherit;
      font-size:0.95rem;
      background:var(--input-bg);
      color:var(--text);
    }
    .input-field:focus, textarea:focus, select:focus{
      border-color:var(--primary);
      outline:none;
      background:#fff;
    }

    textarea{ resize:vertical; }

    .detail-input{
      display:none;
      margin-top:8px;
      border-left:3px solid var(--primary);
      padding-left:10px;
      background:#fff;
    }

    .toggle-group{
      display:flex;
      gap:6px;
      flex-wrap:wrap;
    }
    .toggle-btn{
      border:1px solid #ccc;
      background:#e0e0e0;
      padding:8px 18px;
      border-radius:20px;
      cursor:pointer;
      font-size:0.85rem;
      user-select:none;
      transition:0.2s;
      font-weight:900;
    }
    .toggle-btn:hover{ background:#d0d0d0; }
    .toggle-btn.active{
      background:var(--primary);
      color:white;
      border-color:var(--primary);
      box-shadow:0 2px 5px rgba(0,105,92,0.3);
    }
    .toggle-btn.alert-active{
      background:var(--alert);
      border-color:var(--alert);
      color:white;
    }

    .vitals-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(130px, 1fr));
      gap:12px;
    }
    .vital-box input{
      text-align:center;
      font-weight:900;
      color:var(--primary);
      font-size:1.05rem;
    }
    .vital-box .input-label{
      white-space:nowrap;
    }

    .action-area{
      margin-top:40px;
      display:flex;
      gap:15px;
      flex-wrap:wrap;
    }
    .btn-generate{
      flex:2;
      background:linear-gradient(135deg, #00695c 0%, #004d40 100%);
      color:white;
      padding:20px;
      border:none;
      border-radius:10px;
      font-size:1.05rem;
      font-weight:900;
      cursor:pointer;
      box-shadow:0 4px 15px rgba(0,77,64,0.3);
      transition:transform 0.2s;
    }
    .btn-generate:hover{
      transform:translateY(-2px);
      box-shadow:0 6px 20px rgba(0,77,64,0.35);
    }

    .btn-reset{
      flex:1;
      background:linear-gradient(135deg, var(--gray1) 0%, var(--gray2) 100%);
      color:white;
      padding:20px;
      border:none;
      border-radius:10px;
      font-size:1.05rem;
      font-weight:900;
      cursor:pointer;
      box-shadow:0 4px 15px rgba(0,0,0,0.18);
      transition:transform 0.2s;
    }
    .btn-reset:hover{
      transform:translateY(-2px);
      box-shadow:0 6px 20px rgba(0,0,0,0.22);
    }

    .modal{
      display:none;
      position:fixed;
      top:0; left:0;
      width:100%; height:100%;
      background:rgba(0,0,0,0.6);
      z-index:1000;
      justify-content:center;
      align-items:center;
      backdrop-filter:blur(2px);
    }
    .modal-content{
      background:white;
      width:92%;
      max-width:900px;
      height:88vh;
      padding:22px;
      border-radius:12px;
      display:flex;
      flex-direction:column;
      box-shadow:0 10px 30px rgba(0,0,0,0.3);
    }
    #finalReport{
      flex:1;
      font-family:"Courier New", monospace;
      padding:15px;
      font-size:0.95rem;
      resize:none;
      margin-bottom:12px;
      border:1px solid #ddd;
      border-radius:6px;
      background:#f9f9f9;
      line-height:1.4;
      white-space:pre-wrap;
    }

    .modal-actions{
      display:flex;
      gap:15px;
      flex-wrap:wrap;
    }
    .btn-modal{
      flex:1;
      padding:15px;
      border:none;
      border-radius:8px;
      font-weight:900;
      cursor:pointer;
      color:white;
      font-size:1rem;
      min-width:160px;
    }
    .btn-copy{ background:var(--primary); }
    .btn-pdf{ background:var(--pdf); }
    .btn-close{ background:var(--alert); }

    @media print {
      body { margin: 0; padding: 0; }
      .print-header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        background: white;
        padding: 10px 20px;
        border-bottom: 2px solid #00695c;
        z-index: 1000;
      }
      .print-content {
        margin-top: 120px;
        padding: 20px;
        margin-bottom: 80px;
        page-break-inside: avoid;
      }
      .print-line {
        page-break-inside: avoid;
        margin-bottom: 8px;
      }
      .print-footer {
        position: fixed;
        right: 0;
        bottom: 0;
        padding: 8px 20px;
        font-size: 9pt;
        color: #424242;
      }
    }
/* ALERTA DE AUTO-SAVE */
.autosave-alert {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
  color: white;
  padding: 16px 20px;
  border-radius: 10px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.25);
  z-index: 9999;
  display: none;
  max-width: 90%;
  text-align: center;
}

.autosave-alert.show {
  display: block;
  animation: slideDown 0.3s ease;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateX(-50%) translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }
}

.autosave-alert p {
  margin: 0 0 10px 0;
  font-weight: 700;
  font-size: 0.95rem;
}

.autosave-alert-actions {
  display: flex;
  gap: 10px;
  justify-content: center;
}

.autosave-alert-actions button {
  padding: 8px 16px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 800;
  font-size: 0.85rem;
  transition: transform 0.2s;
}

.autosave-alert-actions button:hover {
  transform: translateY(-2px);
}

.btn-restore {
  background: #4caf50;
  color: white;
}

.btn-discard {
  background: #f44336;
  color: white;
}

/* HIST√ìRICO DE PACIENTES */
.btn-historico {
  position: fixed;
  bottom: 20px;
  right: 20px;
  width: 56px;
  height: 56px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--primary) 0%, #004d40 100%);
  color: white;
  border: none;
  cursor: pointer;
  font-size: 1.5rem;
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  z-index: 999;
  transition: transform 0.2s;
}

.btn-historico:hover {
  transform: scale(1.1);
}

/* Badge de notifica√ß√£o */
.badge-notif {
  position: absolute;
  top: -5px;
  right: -5px;
  background: #f44336;
  color: white;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.7rem;
  font-weight: 900;
  box-shadow: 0 2px 6px rgba(0,0,0,0.3);
}

.modal-historico {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.6);
  z-index: 9998;
  justify-content: center;
  align-items: center;
  backdrop-filter: blur(2px);
}

.modal-historico.show {
  display: flex;
}

.modal-historico-content {
  background: white;
  width: 92%;
  max-width: 700px;
  max-height: 85vh;
  border-radius: 12px;
  padding: 20px;
  display: flex;
  flex-direction: column;
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}

.modal-historico-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 2px solid var(--light);
}

.modal-historico-header h2 {
  margin: 0;
  color: var(--primary);
  font-size: 1.3rem;
}

.btn-fechar-historico {
  background: var(--alert);
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 800;
  font-size: 0.85rem;
}

.search-box {
  margin-bottom: 16px;
}

.search-box input {
  width: 100%;
  padding: 12px;
  border: 1px solid #ccc;
  border-radius: 8px;
  font-size: 1rem;
  box-sizing: border-box;
}

.search-box input:focus {
  border-color: var(--primary);
  outline: none;
}

.lista-pacientes {
  flex: 1;
  overflow-y: auto;
  margin-bottom: 12px;
}

.paciente-item {
  background: #f9f9f9;
  border-left: 4px solid var(--primary);
  padding: 12px;
  margin-bottom: 10px;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s;
}

.paciente-item:hover {
  background: #f0f0f0;
  transform: translateX(4px);
}

.paciente-item-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 6px;
}

.paciente-nome {
  font-weight: 800;
  color: var(--primary);
  font-size: 1.05rem;
}

.paciente-data {
  font-size: 0.8rem;
  color: #666;
  font-weight: 600;
}

.paciente-info {
  font-size: 0.85rem;
  color: #555;
  margin-bottom: 8px;
}

.paciente-actions {
  display: flex;
  gap: 8px;
}

.paciente-actions button {
  flex: 1;
  padding: 6px 12px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 700;
  font-size: 0.8rem;
  transition: transform 0.2s;
}

.paciente-actions button:hover {
  transform: translateY(-2px);
}

.btn-carregar {
  background: var(--primary);
  color: white;
}

.btn-excluir {
  background: var(--alert);
  color: white;
}

.empty-state {
  text-align: center;
  padding: 40px 20px;
  color: #999;
}

.empty-state p {
  font-size: 1.1rem;
  margin: 10px 0;
}

.pacientes-count {
  font-size: 0.85rem;
  color: #666;
  margin-bottom: 12px;
  font-weight: 600;
}

    /* LOGIN overlay */
    #loginOverlay{
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.55);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 99999;
      backdrop-filter: blur(2px);
    }
    #loginBox{
      width: 92%;
      max-width: 420px;
      background: var(--white);
      border-radius: 14px;
      padding: 22px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.30);
      text-align: center;
    }
    #loginBox h2{
      margin: 0 0 8px;
      color: var(--primary);
      font-weight: 900;
      letter-spacing: 1px;
      text-transform: uppercase;
      font-size: 1.1rem;
    }
    #loginBox p{
      margin: 0 0 14px;
      color: var(--gray1);
      font-weight: 700;
      font-size: 0.9rem;
    }
#loginBox .toggle-link {
  margin-top: 12px;
  font-size: 0.85rem;
  color: var(--primary);
  cursor: pointer;
  text-decoration: underline;
}

#loginBox .toggle-link:hover {
  color: #004d40;
}

#loginBox input {
  margin-bottom: 10px;
}

#loginBox .reset-info {
  margin-top: 10px;
  font-size: 0.75rem;
  color: #999;
}
    #loginSenha{
      width: 100%;
      padding: 14px;
      border: 1px solid #ccc;
      border-radius: 10px;
      font-size: 1rem;
      text-align: center;
      outline: none;
      background: #fafafa;
      box-sizing: border-box;
    }
    #loginSenha:focus{
      border-color: var(--primary);
      background: #fff;
    }
    #loginEntrar{
      width: 100%;
      margin-top: 12px;
      padding: 14px;
      border: none;
      border-radius: 10px;
      font-weight: 900;
      cursor: pointer;
      background: linear-gradient(135deg, #00695c 0%, #004d40 100%);
      color: white;
    }
    #loginErro{
      display:none;
      margin-top: 10px;
      color: var(--alert);
      font-weight: 900;
      font-size: 0.85rem;
    }

    /* Emoji nos r√≥tulos */
    .emoji-icon{
      display:inline-block;
      width:1.2em;
      text-align:center;
      margin-right:4px;
      font-size:1.1rem;
      vertical-align:middle;
    }
        /* ============ ESPECIALIDADES - NOVO ============ */
    .btn-especialidades {
      position: absolute;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, #00695c 0%, #004d40 100%);
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-weight: 900;
      font-size: 0.9rem;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0,105,92,0.3);
      transition: all 0.3s;
      z-index: 100;
    }
    .btn-especialidades:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(0,105,92,0.4);
    }

    /* Bot√£o Dark Mode */
    /* Bot√£o Dark Mode - Circular e minimalista */
    .btn-dark-mode {
      position: fixed;
      right: 20px;
      top: 40%;
      transform: translateY(-50%);
      width: 50px;
      height: 50px;
      background: linear-gradient(135deg, #424242 0%, #212121 100%);
      color: white;
      border: none;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      transition: all 0.3s;
      z-index: 9998;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
    }
    .btn-dark-mode:hover {
      transform: translateY(-50%) scale(1.1);
      box-shadow: 0 6px 20px rgba(0,0,0,0.4);
    }

    /* Dark mode ativo - muda cor do bot√£o */
    body.dark-mode .btn-dark-mode {
      background: linear-gradient(135deg, #ffa726 0%, #fb8c00 100%);
    }

    /* Bot√£o Backup */
    .btn-backup {
      position: absolute;
      top: 70px;
      right: 20px;
      background: linear-gradient(135deg, #1976d2 0%, #0d47a1 100%);
      color: white;
      padding: 10px 18px;
      border: none;
      border-radius: 8px;
      font-weight: 900;
      font-size: 0.85rem;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(25,118,210,0.3);
      transition: all 0.3s;
      z-index: 100;
    }
    .btn-backup:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(25,118,210,0.4);
    }

    .modal-especialidades {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.6);
      z-index: 9999;
      justify-content: center;
      align-items: center;
    }
    .modal-especialidades.active {
      display: flex;
    }
    .modal-content-esp {
      background: white;
      padding: 30px;
      border-radius: 12px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }
    .modal-content-esp h2 {
      margin: 0 0 20px;
      color: var(--primary);
      font-size: 1.5rem;
      text-align: center;
    }
    .especialidade-item {
      padding: 15px;
      margin: 10px 0;
      background: var(--light);
      border-radius: 8px;
      cursor: pointer;
      font-weight: 700;
      transition: all 0.2s;
      text-align: center;
    }
    .especialidade-item:hover {
      background: var(--primary);
      color: white;
      transform: translateX(5px);
    }
    .btn-fechar-modal {
      margin-top: 20px;
      width: 100%;
      padding: 12px;
      background: var(--gray1);
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 700;
      cursor: pointer;
    }

    .secao-especializada {
      display: none;
      margin-top: 30px;
      border-top: 3px solid var(--primary);
      padding-top: 20px;
    }
    .secao-especializada.active {
      display: block;
    }
    .badge-especialidade {
      display: inline-block;
      background: var(--primary);
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 900;
      margin-bottom: 20px;
    }

    .checkbox-group {
      margin: 10px 0;
    }
    .checkbox-item {
      display: flex;
      align-items: center;
      margin: 8px 0;
      cursor: pointer;
    }
    .checkbox-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      margin-right: 10px;
      cursor: pointer;
    }
    .checkbox-item label {
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
    }
    .checkbox-subitem {
      margin-left: 35px;
    }

  </style>
</head>

<body>
 <div id="loginOverlay" aria-hidden="false">
    <div id="loginBox">
        <h2>Anamnese Fast</h2>
        
        <!-- TELA DE LOGIN -->
        <div id="telaLogin">
            <p><strong>Seja bem-vindo, √≥timo dia de trabalho!</strong></p>
            <p style="font-size: 0.85rem; margin-top: 8px;">Entre com suas credenciais</p>
            <input id="loginUsuario" type="text" placeholder="Usu√°rio" autocomplete="username">
            <input id="loginSenha" type="password" placeholder="Senha" autocomplete="current-password">
            <button id="loginEntrar" type="button">Entrar</button>
            <div id="loginErro" style="display: none; margin-top: 10px; color: var(--alert); font-weight: 900; font-size: 0.85rem;">Usu√°rio ou senha incorretos.</div>
            <div class="toggle-link" onclick="mostrarReset()">Esqueci minha senha / Resetar credenciais</div>
        </div>
        
        <!-- TELA DE CADASTRO (primeira vez) -->
        <div id="telaCadastro" style="display: none;">
            <p><strong>Primeira vez aqui! Crie suas credenciais:</strong></p>
            <input id="cadastroUsuario" type="text" placeholder="Escolha um usu√°rio" autocomplete="username">
            <input id="cadastroSenha" type="password" placeholder="Escolha uma senha" autocomplete="new-password">
            <input id="cadastroSenhaConfirm" type="password" placeholder="Confirme a senha" autocomplete="new-password">
            <button id="cadastroBotao" type="button">Criar conta</button>
            <div id="cadastroErro" style="display: none; margin-top: 10px; color: var(--alert); font-weight: 900; font-size: 0.85rem;"></div>
        </div>
        
        <!-- TELA DE RESET -->
        <div id="telaReset" style="display: none;">
            <p><strong>Resetar credenciais</strong></p>
            <p style="font-size: 0.85rem; margin-top: 8px;">Isso apagar√° seu usu√°rio e senha atuais.</p>
            <button id="resetConfirmar" type="button" style="background: var(--alert);">Confirmar reset</button>
            <div class="toggle-link" onclick="voltarLogin()">Cancelar</div>
            <div class="reset-info">‚ö†Ô∏è Aten√ß√£o: O hist√≥rico de pacientes ser√° mantido, apenas as credenciais ser√£o apagadas.</div>
        </div>
    </div>
</div>

<!-- ALERTA DE AUTO-SAVE -->
<div id="autosaveAlert" class="autosave-alert">
  <p>üìã Dados salvos encontrados! Deseja restaurar?</p>
  <div class="autosave-alert-actions">
    <button class="btn-restore" onclick="restaurarAutosave()">Restaurar</button>
    <button class="btn-discard" onclick="descartarAutosave()">Come√ßar do zero</button>
  </div>
</div>

<!-- BOT√ÉO FLUTUANTE DE HIST√ìRICO -->
<button id="btnHistorico" class="btn-historico" title="Hist√≥rico de Pacientes">
  üìã
</button>

<!-- BOT√ÉO FLUTUANTE DE LEMBRETES -->
<button onclick="abrirModalLembretes()" class="btn-historico" id="btnLembretes" title="Lembretes de Retorno" style="bottom:90px; position:relative;">
  üîî
  <span id="badge-lembretes" class="badge-notif" style="display:none;">0</span>
</button>

<!-- MODAL DE HIST√ìRICO -->
<div id="modalHistorico" class="modal-historico">
  <div class="modal-historico-content">
    <div class="modal-historico-header">
      <h2>üìã Hist√≥rico de Pacientes</h2>
      <button class="btn-fechar-historico" onclick="fecharHistorico()">Fechar</button>
    </div>

    <div class="search-box">
      <input type="text" id="searchPaciente" placeholder="üîç Buscar por nome do paciente...">
    </div>

    <div class="pacientes-count" id="pacientesCount">
      0 pacientes salvos
    </div>

    <div class="lista-pacientes" id="listaPacientes">
      <div class="empty-state">
        <p>üì≠</p>
        <p>Nenhum paciente salvo ainda</p>
      </div>
    </div>
  </div>
</div>

  <div class="container">
        <!-- BOT√ÉO DARK MODE -->
    <button class="btn-dark-mode" onclick="toggleDarkMode()" id="btnDarkMode">
      üåô Modo Escuro
    </button>

    <!-- BOT√ÉO BACKUP -->
    <button class="btn-backup" onclick="toggleMenuBackup()" id="btnBackup">
      üíæ Backup ‚ñº
    </button>

    <!-- MINI MENU BACKUP -->
    <div id="menuBackup" style="display:none; position:absolute; top:125px; right:20px; background:white; border-radius:8px; box-shadow:0 4px 12px rgba(0,0,0,0.15); padding:10px; z-index:101; min-width:150px;">
      <button onclick="exportarDados()" style="width:100%; padding:10px; margin-bottom:8px; background:#4caf50; color:white; border:none; border-radius:6px; cursor:pointer; font-weight:700; font-size:0.85rem;">üì§ Exportar</button>
      <button onclick="document.getElementById('importFile').click()" style="width:100%; padding:10px; background:#ff9800; color:white; border:none; border-radius:6px; cursor:pointer; font-weight:700; font-size:0.85rem;">üì• Importar</button>
      <input type="file" id="importFile" accept=".json" style="display:none;" onchange="importarDados(event)">
    </div>

        <!-- BOT√ÉO ESPECIALIDADES -->
    <button class="btn-especialidades" onclick="abrirModalEspecialidades()">
      üè• Especialidades ‚ñº
    </button>

    <div class="header">
      <h1>Anamnese Fast</h1>
      <span class="author">Desenvolvido por: Silvestre Azevedo - Acad√™mico de Medicina</span>
      <div style="text-align:center;">
        <img src="perfil.jpg" class="profile-pic" onerror="this.style.display='none'" alt="Foto perfil" />
      </div>
    </div>

<div class="row" style="margin-top: 10px;">
      <div class="col">
        <span class="input-label label-bold" style="color:var(--primary);">RESPONS√ÅVEL PELO ATENDIMENTO</span>
        <input type="text" id="responsavel" class="input-field" placeholder="Seu nome completo (Ex: Dr. Silvestre Azevedo)" />
      </div>
    </div>
    <div class="section-title">Admiss√£o / Evolu√ß√£o</div>

    <div class="row">
      <div class="col">
        <span class="input-label label-bold">PACIENTE</span>
        <input type="text" id="nome" class="input-field" placeholder="Nome do paciente" />
      </div>
      <div class="col" style="flex:0.35;">
        <span class="input-label label-bold">IDADE</span>
        <input type="number" id="idade" class="input-field" placeholder="anos" />
      </div>
      <div class="col" style="flex:0.35;">
        <span class="input-label label-bold">SEXO</span>
        <select id="sexo" class="input-field">
          <option value="M" selected>M</option>
          <option value="F">F</option>
        </select>
      </div>
      <div class="col">
        <span class="input-label label-bold">RELIGI√ÉO</span>
        <input type="text" id="religiao" class="input-field" value="" />
      </div>
    </div>

    <div class="row">
      <div class="col">
        <span class="input-label label-bold">UNIDADE / SETOR</span>
        <input type="text" id="unidade" class="input-field" placeholder="Ex.: PS / UTI / Enfermaria / UBS" />
      </div>
    </div>

    <div class="row">
      <div class="col">
        <span class="input-label label-alert">ALERGIAS MEDICAMENTOSAS</span>
        <div class="toggle-group" id="alergias-group">
          <div class="toggle-btn active" onclick="setOption('alergias','N√£o')">N√ÉO</div>
          <div class="toggle-btn" onclick="setOption('alergias','Sim')">SIM</div>
        </div>
        <input type="text" id="alergias-detalhe" class="input-field detail-input" placeholder="Quais medicamentos? (IMPORTANTE)" />
      </div>

      <div class="col">
        <span class="input-label label-alert">INTERNA√á√ÉO NOS √öLTIMOS 3 MESES?</span>
        <div class="toggle-group" id="internacao-group">
          <div class="toggle-btn active" onclick="setOption('internacao','N√£o')">N√ÉO</div>
          <div class="toggle-btn" onclick="setOption('internacao','Sim')">SIM</div>
        </div>
        <input type="text" id="internacao-detalhe" class="input-field detail-input" placeholder="Motivo / onde / datas (se souber)" />
      </div>
    </div>

    <div class="row">
      <div class="col" style="flex-basis:100%;">
        <span class="input-label label-bold">H√ÅBITOS DE VIDA</span>
      </div>

      <!-- TABAGISMO COM C√ÅLCULO -->
      <div class="col">
        <span class="input-label">Tabagismo</span>
        <div class="toggle-group" id="tabagismo-group">
          <div class="toggle-btn active" onclick="setOption('tabagismo','N√£o')">N√ÉO</div>
          <div class="toggle-btn" onclick="setOption('tabagismo','Sim')">SIM</div>
        </div>

        <input type="text" id="tabagismo-detalhe"
               class="input-field detail-input"
               placeholder="Qtd / frequ√™ncia / ma√ßos-ano" />

        <div id="tabagismo-calc" class="detail-input">
          <div style="margin-top:8px; font-size:0.8rem; font-weight:700;">
            C√°lculo da carga tab√°gica:
          </div>
          <div class="row" style="margin-top:5px; gap:8px;">
            <div class="col">
              <span class="input-label">Cigarros/dia</span>
              <input type="number" id="tab_cigs_dia" class="input-field" min="0"
                     oninput="calcularCargaTabagica()" />
            </div>
            <div class="col">
              <span class="input-label">Anos fumando</span>
              <input type="number" id="tab_anos" class="input-field" min="0" step="0.5"
                     oninput="calcularCargaTabagica()" />
            </div>
          </div>
          <div style="margin-top:6px; font-size:0.85rem; font-weight:800;">
            Carga tab√°gica (ma√ßos-ano):
            <span id="tab_carga" style="color:var(--primary);">0</span>
          </div>
        </div>
      </div>

      <div class="col">
        <span class="input-label">Etilismo</span>
        <div class="toggle-group" id="etilismo-group">
          <div class="toggle-btn active" onclick="setOption('etilismo','N√£o')">N√ÉO</div>
          <div class="toggle-btn" onclick="setOption('etilismo','Sim')">SIM</div>
        </div>
        <input type="text" id="etilismo-detalhe" class="input-field detail-input" placeholder="Qtd / frequ√™ncia / tempo de uso" />
      </div>

      <div class="col">
        <span class="input-label">Drogas il√≠citas</span>
        <div class="toggle-group" id="drogas-group">
          <div class="toggle-btn active" onclick="setOption('drogas','N√£o')">N√ÉO</div>
          <div class="toggle-btn" onclick="setOption('drogas','Sim')">SIM</div>
        </div>
        <input type="text" id="drogas-detalhe" class="input-field detail-input" placeholder="Qual subst√¢ncia / padr√£o de uso" />
      </div>
    </div>

    <div class="section-title">Hist√≥ria</div>

    <span class="input-label label-bold">QUEIXA PRINCIPAL (QP)</span>
    <input type="text" id="qp" class="input-field" style="margin-bottom:10px;" placeholder="Descreva a QP" />

    <span class="input-label label-bold">HIST√ìRIA DA DOEN√áA ATUAL (HDA)</span>
    
    <!-- Barra de formata√ß√£o HDA -->
    <div style="display:flex; gap:8px; margin-bottom:8px; flex-wrap:wrap;">
      <button type="button" onclick="formatarHDA('bold')" style="padding:6px 12px; background:#555; color:white; border:none; border-radius:4px; cursor:pointer; font-weight:900; font-size:0.85rem;" title="Negrito">
        <strong>B</strong>
      </button>
      <button type="button" onclick="formatarHDA('italic')" style="padding:6px 12px; background:#555; color:white; border:none; border-radius:4px; cursor:pointer; font-style:italic; font-size:0.85rem;" title="It√°lico">
        <em>I</em>
      </button>
      <select id="hdaFontSize" style="padding:6px 10px; border:1px solid #ccc; border-radius:4px; font-size:0.85rem; cursor:pointer;">
        <option value="">Tamanho</option>
        <option value="small">Pequeno</option>
        <option value="normal">Normal</option>
        <option value="large">Grande</option>
      </select>
      <button type="button" onclick="aplicarTamanhoFonteHDA()" style="padding:6px 12px; background:#00695c; color:white; border:none; border-radius:4px; cursor:pointer; font-weight:700; font-size:0.85rem;">
        Aplicar tamanho
      </button>
    </div>
    
    <textarea id="hda" rows="4" placeholder="Descreva a HDA..."></textarea>

    <div class="row">
      <div class="col">
        <span class="input-label label-bold">HIST√ìRIA PATOL√ìGICA PREGRESSA (HPP)</span>
        <textarea id="hpp" rows="3" placeholder="Comorbidades, cirurgias, interna√ß√µes pr√©vias, uso cr√¥nico de medicamentos etc."></textarea>
      </div>
      <div class="col">
        <span class="input-label label-bold">MEDICAMENTOS DE USO CONT√çNUO</span>
        <textarea id="meds_continuos" rows="3" placeholder="01 - "></textarea>
      </div>
    </div>

    <div class="row">
  <div class="col">
    <span class="input-label label-bold">HIST√ìRIA FAMILIAR (HF)</span>
    <textarea id="hf" rows="3" placeholder="Doen√ßas na fam√≠lia, causas de √≥bito relevantes, doen√ßas heredit√°rias etc."></textarea>
  </div>
  <div class="col">
    <span class="input-label label-bold">EXAMES LABORATORIAIS</span>
    <textarea id="labs" rows="3" placeholder="Cole/registre aqui os resultados (hemograma, eletr√≥litos, gaso, etc.)."></textarea>
  </div>
</div>

<div class="row">
  <div class="col">
    <span class="input-label label-bold">EXAMES DE IMAGEM</span>
    <textarea id="imagem" rows="3"
      placeholder="Laudos e principais achados de RX, TC, RM, USG, eco, etc."></textarea>
  </div>
</div>

    <div class="section-title">Exame F√≠sico</div>

    <span class="input-label label-bold">Sinais Vitais</span>
    <div class="vitals-grid" style="margin-bottom:12px;">
      <div class="vital-box">
        <span class="input-label">
          <span class="emoji-icon" role="img" aria-label="press√£o arterial">ü©∫</span>
          PA (mmHg)
        </span>
        <input type="text" id="pa" class="input-field" placeholder="120x80" />
      </div>
      <div class="vital-box">
        <span class="input-label">
          <span class="emoji-icon" role="img" aria-label="frequ√™ncia card√≠aca">‚ù§Ô∏è</span>
          FC (bpm)
        </span>
        <input type="number" id="fc" class="input-field" placeholder="80" />
      </div>
      <div class="vital-box">
        <span class="input-label">
          <span class="emoji-icon" role="img" aria-label="frequ√™ncia respirat√≥ria">ü´Å</span>
          FR (ipm)
        </span>
        <input type="number" id="fr" class="input-field" placeholder="18" />
      </div>
      <div class="vital-box">
        <span class="input-label">
          <span class="emoji-icon" role="img" aria-label="satura√ß√£o de oxig√™nio">ü©∏</span>
          SatO2 (%)
        </span>
        <input type="number" id="sat" class="input-field" placeholder="98" />
      </div>
      <div class="vital-box">
        <span class="input-label">
          <span class="emoji-icon" role="img" aria-label="temperatura">üå°Ô∏è</span>
          T (¬∞C)
        </span>
        <input type="number" step="0.1" id="temp" class="input-field" placeholder="36.5" />
      </div>
      <div class="vital-box">
        <span class="input-label">
          <span class="emoji-icon" role="img" aria-label="glicemia capilar">üç¨</span>
          Glicemia (mg/dL)
        </span>
        <input type="number" id="hgt" class="input-field" placeholder="100" />
      </div>
    </div>

    <div class="section-title">Ectoscopia e Segmentar</div>

    <span class="input-label label-bold">ECTOSCOPIA</span>
    <textarea id="ef_ectoscopia" rows="3"></textarea>

    <div class="row" style="margin-top:10px;">
      <div class="col">
        <span class="input-label label-bold">Cabe√ßa e pesco√ßo</span>
        <textarea id="ef_cp" rows="3"></textarea>
      </div>
      <div class="col">
        <span class="input-label label-bold">ACV</span>
        <textarea id="ef_acv" rows="3"></textarea>
      </div>
    </div>

    <div class="row">
      <div class="col">
        <span class="input-label label-bold">AP</span>
        <textarea id="ef_ap" rows="3"></textarea>
      </div>
      <div class="col">
        <span class="input-label label-bold">ABD</span>
        <textarea id="ef_abd" rows="3"></textarea>
      </div>
    </div>

    <span class="input-label label-bold">NEURO</span>
    <textarea id="ef_neuro" rows="3"></textarea>

    <span class="input-label label-bold" style="margin-top:10px;">MEMBROS</span>
    <textarea id="ef_membros" rows="2"></textarea>

    <div class="section-title">Exame Neurol√≥gico Detalhado</div>
    <textarea id="neuro_detalhado" rows="10"></textarea>

    <!-- ============ SE√á√ÉO: DIAGN√ìSTICOS DIFERENCIAIS ============ -->
    <div class="section-title">üîç Diagn√≥sticos Diferenciais / Hip√≥teses Diagn√≥sticas</div>
    
    <div style="margin-bottom:15px;">
      <div style="display:flex; gap:10px; margin-bottom:10px; align-items:center;">
        <input type="text" id="busca-cid" class="input-field" placeholder="üîé Buscar CID-10 (ex: diabetes, J18, pneumonia)" style="flex:2;" />
        <button type="button" onclick="buscarCID10()" style="flex:0.5; padding:10px; background:#00695c; color:white; border:none; border-radius:6px; cursor:pointer; font-weight:700;">Buscar</button>
      </div>
      
      <div id="resultados-cid" style="display:none; max-height:200px; overflow-y:auto; border:1px solid #ccc; border-radius:6px; padding:10px; background:#fafafa; margin-bottom:10px;">
        <!-- Resultados da busca aparecem aqui -->
      </div>
    </div>

    <div id="diagnosticos-lista" style="margin-bottom:15px;">
      <!-- Lista de diagn√≥sticos selecionados -->
    </div>

    <div class="row">
      <div class="col">
        <span class="input-label label-bold">HIP√ìTESE DIAGN√ìSTICA 1 (Principal)</span>
        <div style="display:flex; gap:8px; align-items:center;">
          <input type="text" id="hd1" class="input-field" placeholder="Diagn√≥stico principal" style="flex:2;" />
          <input type="text" id="hd1-cid" class="input-field" placeholder="CID-10" style="flex:1;" />
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col">
        <span class="input-label">Hip√≥tese Diagn√≥stica 2</span>
        <div style="display:flex; gap:8px; align-items:center;">
          <input type="text" id="hd2" class="input-field" placeholder="Diagn√≥stico diferencial" style="flex:2;" />
          <input type="text" id="hd2-cid" class="input-field" placeholder="CID-10" style="flex:1;" />
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col">
        <span class="input-label">Hip√≥tese Diagn√≥stica 3</span>
        <div style="display:flex; gap:8px; align-items:center;">
          <input type="text" id="hd3" class="input-field" placeholder="Diagn√≥stico diferencial" style="flex:2;" />
          <input type="text" id="hd3-cid" class="input-field" placeholder="CID-10" style="flex:1;" />
        </div>
      </div>
    </div>

    <!-- ============ SE√á√ÉO: CONDUTA E PLANO TERAP√äUTICO ============ -->
    <div class="section-title">üíä Conduta e Plano Terap√™utico</div>
    
    <div class="row">
      <div class="col">
        <span class="input-label label-bold">EXAMES SOLICITADOS</span>
        <textarea id="exames-solicitados" rows="4" placeholder="Liste os exames complementares solicitados (ex: Hemograma, Raio-X de t√≥rax, Glicemia...)"></textarea>
      </div>
    </div>

    <div class="row">
      <div class="col">
        <span class="input-label label-bold">PRESCRI√á√ÉO / TRATAMENTO</span>
        <textarea id="prescricao" rows="6" placeholder="01 - &#10;02 - &#10;03 - "></textarea>
      </div>
    </div>

    <div class="row">
      <div class="col">
        <span class="input-label label-bold">ORIENTA√á√ïES AO PACIENTE</span>
        <textarea id="orientacoes" rows="4" placeholder="Orienta√ß√µes gerais, cuidados, sinais de alerta, recomenda√ß√µes..."></textarea>
      </div>
    </div>

    <div class="row">
      <div class="col">
        <span class="input-label label-bold">PLANO DE SEGUIMENTO</span>
        <textarea id="seguimento" rows="3" placeholder="Retorno, reavalia√ß√£o, encaminhamentos..."></textarea>
      </div>
      <div class="col">
        <span class="input-label label-bold">‚è∞ LEMBRETE DE RETORNO</span>
        <input type="date" id="data-retorno" class="input-field" />
        <textarea id="obs-retorno" rows="2" placeholder="Observa√ß√µes do retorno..." style="margin-top:8px;"></textarea>
        <button type="button" onclick="salvarLembrete()" style="margin-top:8px; width:100%; padding:10px; background:#ff9800; color:white; border:none; border-radius:6px; cursor:pointer; font-weight:700;">
          üîî Salvar Lembrete
        </button>
      </div>
    </div>

    <div class="action-area">
            <!-- ============ SE√á√ÉO ESPECIALIZADA - GASTROENTEROLOGIA ============ -->
    <div id="secao-gastro" class="secao-especializada">
      <span class="badge-especialidade">üè• ANAMNESE - GASTROENTEROLOGIA</span>

      <div class="section-title">üî• 3. Dor Abdominal</div>
      <div class="checkbox-group">
        <div class="checkbox-item">
          <input type="checkbox" id="dor-abdominal" onchange="toggleDorAbdominal()">
          <label for="dor-abdominal">Apresenta dor abdominal</label>
        </div>
      </div>

      <div id="dor-abdominal-detalhes" style="display:none; margin-left:20px;">
        <span class="input-label label-bold">Localiza√ß√£o</span>
        <div class="checkbox-group">
          <div class="checkbox-item"><input type="checkbox" id="loc-epigastrio"><label for="loc-epigastrio">Epig√°strio</label></div>
          <div class="checkbox-item"><input type="checkbox" id="loc-hd"><label for="loc-hd">Hipoc√¥ndrio direito</label></div>
          <div class="checkbox-item"><input type="checkbox" id="loc-he"><label for="loc-he">Hipoc√¥ndrio esquerdo</label></div>
          <div class="checkbox-item"><input type="checkbox" id="loc-peri"><label for="loc-peri">Periumbilical</label></div>
          <div class="checkbox-item"><input type="checkbox" id="loc-fid"><label for="loc-fid">Fossa il√≠aca direita</label></div>
          <div class="checkbox-item"><input type="checkbox" id="loc-fie"><label for="loc-fie">Fossa il√≠aca esquerda</label></div>
          <div class="checkbox-item"><input type="checkbox" id="loc-difusa"><label for="loc-difusa">Difusa</label></div>
        </div>

        <span class="input-label label-bold">Tipo</span>
        <div class="checkbox-group">
          <div class="checkbox-item"><input type="checkbox" id="tipo-queimacao"><label for="tipo-queimacao">Queima√ß√£o</label></div>
          <div class="checkbox-item"><input type="checkbox" id="tipo-colica"><label for="tipo-colica">C√≥lica</label></div>
          <div class="checkbox-item"><input type="checkbox" id="tipo-peso"><label for="tipo-peso">Peso</label></div>
          <div class="checkbox-item"><input type="checkbox" id="tipo-pontada"><label for="tipo-pontada">Pontada</label></div>
        </div>

        <span class="input-label label-bold">Intensidade</span>
        <div class="checkbox-group">
          <div class="checkbox-item"><input type="checkbox" id="int-leve"><label for="int-leve">Leve</label></div>
          <div class="checkbox-item"><input type="checkbox" id="int-moderada"><label for="int-moderada">Moderada</label></div>
          <div class="checkbox-item"><input type="checkbox" id="int-intensa"><label for="int-intensa">Intensa</label></div>
        </div>

        <span class="input-label label-bold">Irradia√ß√£o</span>
        <div class="checkbox-group">
          <div class="checkbox-item"><input type="checkbox" id="irrad-dorso"><label for="irrad-dorso">Dorso</label></div>
          <div class="checkbox-item"><input type="checkbox" id="irrad-ombro"><label for="irrad-ombro">Ombro direito</label></div>
          <div class="checkbox-item"><input type="checkbox" id="irrad-nao"><label for="irrad-nao">N√£o irradia</label></div>
        </div>

        <span class="input-label label-bold">Rela√ß√£o</span>
        <div class="checkbox-group">
          <div class="checkbox-item"><input type="checkbox" id="rel-piora-alim"><label for="rel-piora-alim">Piora ap√≥s alimenta√ß√£o</label></div>
          <div class="checkbox-item"><input type="checkbox" id="rel-jejum"><label for="rel-jejum">Melhora em jejum</label></div>
          <div class="checkbox-item"><input type="checkbox" id="rel-evac"><label for="rel-evac">Melhora ap√≥s evacua√ß√£o</label></div>
          <div class="checkbox-item"><input type="checkbox" id="rel-noturna"><label for="rel-noturna">Dor noturna</label></div>
        </div>
      </div>

      <div class="section-title">üîº 4. Sintomas Digestivos Altos</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="azia"><label for="azia">Azia / Pirose</label></div>
        <div class="checkbox-item"><input type="checkbox" id="regurg"><label for="regurg">Regurgita√ß√£o</label></div>
        <div class="checkbox-item"><input type="checkbox" id="nauseas"><label for="nauseas">N√°useas</label></div>
        <div class="checkbox-item">
          <input type="checkbox" id="vomitos" onchange="toggleVomitos()">
          <label for="vomitos">V√¥mitos</label>
        </div>
        <div id="vomitos-detalhes" style="display:none;" class="checkbox-subitem">
          <div class="checkbox-item"><input type="checkbox" id="vom-alim"><label for="vom-alim">Alimentares</label></div>
          <div class="checkbox-item"><input type="checkbox" id="vom-bil"><label for="vom-bil">Biliosos</label></div>
          <div class="checkbox-item"><input type="checkbox" id="vom-sangue"><label for="vom-sangue">Com sangue (hemat√™mese)</label></div>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="disfagia" onchange="toggleDisfagia()">
          <label for="disfagia">Disfagia</label>
        </div>
        <div id="disfagia-detalhes" style="display:none;" class="checkbox-subitem">
          <div class="checkbox-item"><input type="checkbox" id="disf-sol"><label for="disf-sol">S√≥lidos</label></div>
          <div class="checkbox-item"><input type="checkbox" id="disf-liq"><label for="disf-liq">L√≠quidos</label></div>
          <div class="checkbox-item"><input type="checkbox" id="disf-ambos"><label for="disf-ambos">Ambos</label></div>
        </div>
        <div class="checkbox-item"><input type="checkbox" id="odinofagia"><label for="odinofagia">Odinofagia</label></div>
        <div class="checkbox-item"><input type="checkbox" id="saciedade"><label for="saciedade">Saciedade precoce</label></div>
        <div class="checkbox-item"><input type="checkbox" id="plenitude"><label for="plenitude">Plenitude p√≥s-prandial</label></div>
      </div>

      <div class="section-title">üîΩ 5. Sintomas Digestivos Baixos</div>
      <div class="checkbox-group">
        <div class="checkbox-item">
          <input type="checkbox" id="diarreia" onchange="toggleDiarreia()">
          <label for="diarreia">Diarreia</label>
        </div>
        <div id="diarreia-detalhes" style="display:none;" class="checkbox-subitem">
          <div class="checkbox-item"><input type="checkbox" id="diarr-aguda"><label for="diarr-aguda">Aguda</label></div>
          <div class="checkbox-item"><input type="checkbox" id="diarr-cronica"><label for="diarr-cronica">Cr√¥nica</label></div>
        </div>
        <div class="checkbox-item"><input type="checkbox" id="constipacao"><label for="constipacao">Constipa√ß√£o</label></div>
        <div class="checkbox-item"><input type="checkbox" id="alternancia"><label for="alternancia">Altern√¢ncia diarreia/constipa√ß√£o</label></div>
        <div class="checkbox-item"><input type="checkbox" id="tenesmo"><label for="tenesmo">Tenesmo</label></div>
        <div class="checkbox-item"><input type="checkbox" id="urgencia"><label for="urgencia">Urg√™ncia evacuat√≥ria</label></div>
      </div>

      <div class="section-title">üí© 6. Caracter√≠sticas das Fezes</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="fezes-normais"><label for="fezes-normais">Normais</label></div>
        <div class="checkbox-item"><input type="checkbox" id="fezes-pastosas"><label for="fezes-pastosas">Pastosas</label></div>
        <div class="checkbox-item"><input type="checkbox" id="fezes-liquidas"><label for="fezes-liquidas">L√≠quidas</label></div>
        <div class="checkbox-item"><input type="checkbox" id="fezes-duras"><label for="fezes-duras">Endurecidas</label></div>
        <div class="checkbox-item"><input type="checkbox" id="fezes-melena"><label for="fezes-melena">Escuras (melena)</label></div>
        <div class="checkbox-item"><input type="checkbox" id="fezes-sangue"><label for="fezes-sangue">Com sangue vivo</label></div>
        <div class="checkbox-item"><input type="checkbox" id="fezes-muco"><label for="fezes-muco">Com muco</label></div>
        <div class="checkbox-item"><input type="checkbox" id="fezes-oleosas"><label for="fezes-oleosas">Oleosas / brilhantes (esteatorreia)</label></div>
      </div>

      <div class="section-title">üü° 7. Icter√≠cia / Hepatobiliar</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="ict-olhos"><label for="ict-olhos">Olhos amarelados</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ict-pele"><label for="ict-pele">Pele amarelada</label></div>
        <div class="checkbox-item"><input type="checkbox" id="urina-escura"><label for="urina-escura">Urina escura</label></div>
        <div class="checkbox-item"><input type="checkbox" id="fezes-claras"><label for="fezes-claras">Fezes claras</label></div>
        <div class="checkbox-item"><input type="checkbox" id="prurido"><label for="prurido">Prurido</label></div>
        <div class="checkbox-item"><input type="checkbox" id="dor-hd-gastro"><label for="dor-hd-gastro">Dor em hipoc√¥ndrio direito</label></div>
      </div>

      <div class="section-title">üå°Ô∏è 8. Sintomas Sist√™micos</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="febre-gastro"><label for="febre-gastro">Febre</label></div>
        <div class="checkbox-item"><input type="checkbox" id="perda-peso"><label for="perda-peso">Perda de peso involunt√°ria</label></div>
        <div class="checkbox-item"><input type="checkbox" id="anorexia-gastro"><label for="anorexia-gastro">Anorexia</label></div>
        <div class="checkbox-item"><input type="checkbox" id="fadiga-gastro"><label for="fadiga-gastro">Fadiga</label></div>
        <div class="checkbox-item"><input type="checkbox" id="sudorese"><label for="sudorese">Sudorese noturna</label></div>
      </div>

      <div class="section-title">üè• 9. Antecedentes Gastrointestinais</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="ant-gastrite"><label for="ant-gastrite">Gastrite</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ant-drge"><label for="ant-drge">DRGE</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ant-ulcera"><label for="ant-ulcera">√ölcera p√©ptica</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ant-hepatite"><label for="ant-hepatite">Hepatite</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ant-cirrose"><label for="ant-cirrose">Cirrose</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ant-colel"><label for="ant-colel">Colelit√≠ase</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ant-panc"><label for="ant-panc">Pancreatite</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ant-crohn"><label for="ant-crohn">Doen√ßa de Crohn</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ant-rcu"><label for="ant-rcu">Retocolite Ulcerativa</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ant-cirurg"><label for="ant-cirurg">Cirurgia abdominal pr√©via</label></div>
      </div>

      <div class="section-title">üíä 10. Uso de Medicamentos</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="med-aines"><label for="med-aines">AINEs</label></div>
        <div class="checkbox-item"><input type="checkbox" id="med-cortic"><label for="med-cortic">Corticoides</label></div>
        <div class="checkbox-item"><input type="checkbox" id="med-atb"><label for="med-atb">Antibi√≥ticos recentes</label></div>
        <div class="checkbox-item"><input type="checkbox" id="med-ibp"><label for="med-ibp">IBP / Anti√°cidos</label></div>
        <div class="checkbox-item"><input type="checkbox" id="med-lax"><label for="med-lax">Laxantes</label></div>
        <div class="checkbox-item"><input type="checkbox" id="med-fito"><label for="med-fito">Fitoter√°picos</label></div>
      </div>

      <div class="section-title">üç∫ 11. H√°bitos de Vida</div>
      <div class="checkbox-group">
        <div class="checkbox-item">
          <input type="checkbox" id="hab-etil" onchange="toggleEtilismoGastro()">
          <label for="hab-etil">Etilismo</label>
        </div>
        <div id="etilismo-detalhes-gastro" style="display:none;" class="checkbox-subitem">
          <div class="checkbox-item"><input type="checkbox" id="etil-social"><label for="etil-social">Social</label></div>
          <div class="checkbox-item"><input type="checkbox" id="etil-freq"><label for="etil-freq">Frequente</label></div>
          <div class="checkbox-item"><input type="checkbox" id="etil-pesado"><label for="etil-pesado">Pesado</label></div>
        </div>
        <div class="checkbox-item"><input type="checkbox" id="hab-tab"><label for="hab-tab">Tabagismo</label></div>
        <div class="checkbox-item"><input type="checkbox" id="hab-drogas"><label for="hab-drogas">Drogas il√≠citas</label></div>
        <div class="checkbox-item"><input type="checkbox" id="hab-gord"><label for="hab-gord">Dieta rica em gordura</label></div>
        <div class="checkbox-item"><input type="checkbox" id="hab-lact"><label for="hab-lact">Consumo excessivo de lactose</label></div>
        <div class="checkbox-item"><input type="checkbox" id="hab-gluten"><label for="hab-gluten">Consumo de gl√∫ten</label></div>
      </div>

      <div class="section-title">üë®‚Äçüë©‚Äçüëß 12. Antecedentes Familiares</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="fam-cancer"><label for="fam-cancer">C√¢ncer gastrointestinal</label></div>
        <div class="checkbox-item"><input type="checkbox" id="fam-dii"><label for="fam-dii">Doen√ßa inflamat√≥ria intestinal</label></div>
        <div class="checkbox-item"><input type="checkbox" id="fam-hepat"><label for="fam-hepat">Doen√ßa hep√°tica</label></div>
        <div class="checkbox-item"><input type="checkbox" id="fam-polipose"><label for="fam-polipose">Polipose familiar</label></div>
      </div>

      <div class="section-title">üö® 13. Sinais de Alarme</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="alarm-peso"><label for="alarm-peso">Perda de peso inexplicada</label></div>
        <div class="checkbox-item"><input type="checkbox" id="alarm-anemia"><label for="alarm-anemia">Anemia</label></div>
        <div class="checkbox-item"><input type="checkbox" id="alarm-sangr"><label for="alarm-sangr">Sangramento digestivo</label></div>
        <div class="checkbox-item"><input type="checkbox" id="alarm-disf"><label for="alarm-disf">Disfagia progressiva</label></div>
        <div class="checkbox-item"><input type="checkbox" id="alarm-vom"><label for="alarm-vom">V√¥mitos persistentes</label></div>
        <div class="checkbox-item"><input type="checkbox" id="alarm-dor"><label for="alarm-dor">Dor abdominal noturna</label></div>
        <div class="checkbox-item"><input type="checkbox" id="alarm-hf"><label for="alarm-hf">Hist√≥ria familiar de c√¢ncer GI</label></div>
      </div>

      <div class="section-title">üìù 14. Observa√ß√µes Finais</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="obs-qv"><label for="obs-qv">Impacto na qualidade de vida</label></div>
        <div class="checkbox-item"><input type="checkbox" id="obs-expect"><label for="obs-expect">Expectativa do paciente</label></div>
      </div>
      <textarea id="obs-outras" rows="3" placeholder="Outras informa√ß√µes relevantes..."></textarea>
    </div>
    <!-- ============ FIM SE√á√ÉO GASTROENTEROLOGIA ============ -->

    <!-- ============ SE√á√ÉO ESPECIALIZADA - PSIQUIATRIA ============ -->
    <div id="secao-psiq" class="secao-especializada">
      <span class="badge-especialidade">üß† ANAMNESE - PSIQUIATRIA</span>

      <div class="section-title">üó£Ô∏è 1. Motivo da Consulta</div>
      <textarea id="psiq-motivo" rows="2" placeholder="Descreva o motivo da consulta psiqui√°trica..."></textarea>

      <div class="section-title">üìã 2. Queixa Principal e HDA Psiqui√°trica</div>
      <textarea id="psiq-hda" rows="4" placeholder="Hist√≥ria detalhada dos sintomas psiqui√°tricos (in√≠cio, evolu√ß√£o, fatores desencadeantes, tratamentos pr√©vios)..."></textarea>

      <div class="section-title">üòî 3. Humor e Afeto</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="humor-deprimido"><label for="humor-deprimido">Humor deprimido</label></div>
        <div class="checkbox-item"><input type="checkbox" id="humor-elevado"><label for="humor-elevado">Humor elevado/euf√≥rico</label></div>
        <div class="checkbox-item"><input type="checkbox" id="humor-irritavel"><label for="humor-irritavel">Humor irrit√°vel</label></div>
        <div class="checkbox-item"><input type="checkbox" id="humor-ansioso"><label for="humor-ansioso">Humor ansioso</label></div>
        <div class="checkbox-item"><input type="checkbox" id="humor-labil"><label for="humor-labil">Humor l√°bil</label></div>
        <div class="checkbox-item"><input type="checkbox" id="humor-embotado"><label for="humor-embotado">Afeto embotado/achatado</label></div>
        <div class="checkbox-item"><input type="checkbox" id="humor-inadequado"><label for="humor-inadequado">Afeto inadequado</label></div>
        <div class="checkbox-item"><input type="checkbox" id="anedonia"><label for="anedonia">Anedonia (perda de prazer)</label></div>
      </div>

      <div class="section-title">üò∞ 4. Sintomas Ansiosos</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="ansiedade-geral"><label for="ansiedade-geral">Ansiedade generalizada</label></div>
        <div class="checkbox-item"><input type="checkbox" id="panico"><label for="panico">Crises de p√¢nico</label></div>
        <div class="checkbox-item"><input type="checkbox" id="fobias"><label for="fobias">Fobias espec√≠ficas</label></div>
        <div class="checkbox-item"><input type="checkbox" id="fobia-social"><label for="fobia-social">Fobia social</label></div>
        <div class="checkbox-item"><input type="checkbox" id="agorafobia"><label for="agorafobia">Agorafobia</label></div>
        <div class="checkbox-item"><input type="checkbox" id="toc"><label for="toc">Sintomas obsessivo-compulsivos</label></div>
        <div class="checkbox-item"><input type="checkbox" id="estresse-pos"><label for="estresse-pos">Estresse p√≥s-traum√°tico</label></div>
        <div class="checkbox-item"><input type="checkbox" id="preocup-excessiva"><label for="preocup-excessiva">Preocupa√ß√£o excessiva</label></div>
        <div class="checkbox-item"><input type="checkbox" id="tensao-muscular"><label for="tensao-muscular">Tens√£o muscular</label></div>
        <div class="checkbox-item"><input type="checkbox" id="inquietacao"><label for="inquietacao">Inquieta√ß√£o</label></div>
      </div>

      <div class="section-title">üí≠ 5. Pensamento</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="pensa-lento"><label for="pensa-lento">Pensamento lentificado</label></div>
        <div class="checkbox-item"><input type="checkbox" id="pensa-acelerado"><label for="pensa-acelerado">Pensamento acelerado</label></div>
        <div class="checkbox-item"><input type="checkbox" id="pensa-desorg"><label for="pensa-desorg">Pensamento desorganizado</label></div>
        <div class="checkbox-item"><input type="checkbox" id="pensa-persev"><label for="pensa-persev">Persevera√ß√£o</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ideias-delic"><label for="ideias-delic">Ideias delirantes</label></div>
        <div class="checkbox-item"><input type="checkbox" id="delic-perseg"><label for="delic-perseg">Del√≠rios persecut√≥rios</label></div>
        <div class="checkbox-item"><input type="checkbox" id="delic-grandeza"><label for="delic-grandeza">Del√≠rios de grandeza</label></div>
        <div class="checkbox-item"><input type="checkbox" id="delic-ruina"><label for="delic-ruina">Del√≠rios de ru√≠na</label></div>
        <div class="checkbox-item"><input type="checkbox" id="delic-culpa"><label for="delic-culpa">Del√≠rios de culpa</label></div>
        <div class="checkbox-item"><input type="checkbox" id="pensa-magico"><label for="pensa-magico">Pensamento m√°gico</label></div>
        <div class="checkbox-item"><input type="checkbox" id="obsessoes"><label for="obsessoes">Obsess√µes</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ruminacoes"><label for="ruminacoes">Rumina√ß√µes</label></div>
      </div>

      <div class="section-title">üëÅÔ∏è 6. Percep√ß√£o</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="aluc-auditivas"><label for="aluc-auditivas">Alucina√ß√µes auditivas</label></div>
        <div class="checkbox-item"><input type="checkbox" id="aluc-visuais"><label for="aluc-visuais">Alucina√ß√µes visuais</label></div>
        <div class="checkbox-item"><input type="checkbox" id="aluc-tateis"><label for="aluc-tateis">Alucina√ß√µes t√°teis</label></div>
        <div class="checkbox-item"><input type="checkbox" id="aluc-olfativas"><label for="aluc-olfativas">Alucina√ß√µes olfativas</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ilusoes"><label for="ilusoes">Ilus√µes</label></div>
        <div class="checkbox-item"><input type="checkbox" id="desperson"><label for="desperson">Despersonaliza√ß√£o</label></div>
        <div class="checkbox-item"><input type="checkbox" id="desreal"><label for="desreal">Desrealiza√ß√£o</label></div>
      </div>

      <div class="section-title">üß≠ 7. Orienta√ß√£o e Consci√™ncia</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="orient-preserv"><label for="orient-preserv">Orientado (tempo, espa√ßo, pessoa)</label></div>
        <div class="checkbox-item"><input type="checkbox" id="desorient-tempo"><label for="desorient-tempo">Desorientado no tempo</label></div>
        <div class="checkbox-item"><input type="checkbox" id="desorient-esp"><label for="desorient-esp">Desorientado no espa√ßo</label></div>
        <div class="checkbox-item"><input type="checkbox" id="desorient-pess"><label for="desorient-pess">Desorientado quanto √† pessoa</label></div>
        <div class="checkbox-item"><input type="checkbox" id="confusao-mental"><label for="confusao-mental">Confus√£o mental</label></div>
        <div class="checkbox-item"><input type="checkbox" id="rebaixa-consc"><label for="rebaixa-consc">Rebaixamento do n√≠vel de consci√™ncia</label></div>
      </div>

      <div class="section-title">üß† 8. Mem√≥ria e Cogni√ß√£o</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="mem-recente-alt"><label for="mem-recente-alt">Mem√≥ria recente alterada</label></div>
        <div class="checkbox-item"><input type="checkbox" id="mem-remota-alt"><label for="mem-remota-alt">Mem√≥ria remota alterada</label></div>
        <div class="checkbox-item"><input type="checkbox" id="amnesia"><label for="amnesia">Amn√©sia</label></div>
        <div class="checkbox-item"><input type="checkbox" id="confabula"><label for="confabula">Confabula√ß√£o</label></div>
        <div class="checkbox-item"><input type="checkbox" id="deficit-atenc"><label for="deficit-atenc">D√©ficit de aten√ß√£o/concentra√ß√£o</label></div>
        <div class="checkbox-item"><input type="checkbox" id="deficit-exec"><label for="deficit-exec">D√©ficit de fun√ß√µes executivas</label></div>
        <div class="checkbox-item"><input type="checkbox" id="deficit-linguagem"><label for="deficit-linguagem">D√©ficit de linguagem</label></div>
      </div>

      <div class="section-title">üí§ 9. Sono</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="insonia-inicial"><label for="insonia-inicial">Ins√¥nia inicial (dificuldade para dormir)</label></div>
        <div class="checkbox-item"><input type="checkbox" id="insonia-manut"><label for="insonia-manut">Ins√¥nia de manuten√ß√£o (despertares noturnos)</label></div>
        <div class="checkbox-item"><input type="checkbox" id="insonia-terminal"><label for="insonia-terminal">Ins√¥nia terminal (despertar precoce)</label></div>
        <div class="checkbox-item"><input type="checkbox" id="hipersonia"><label for="hipersonia">Hipersonia</label></div>
        <div class="checkbox-item"><input type="checkbox" id="pesadelos"><label for="pesadelos">Pesadelos frequentes</label></div>
        <div class="checkbox-item"><input type="checkbox" id="terror-noturno"><label for="terror-noturno">Terror noturno</label></div>
        <div class="checkbox-item"><input type="checkbox" id="sono-nao-repousante"><label for="sono-nao-repousante">Sono n√£o repousante</label></div>
      </div>

      <div class="section-title">üçΩÔ∏è 10. Apetite e Alimenta√ß√£o</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="apetite-reduz"><label for="apetite-reduz">Apetite reduzido</label></div>
        <div class="checkbox-item"><input type="checkbox" id="apetite-aument"><label for="apetite-aument">Apetite aumentado</label></div>
        <div class="checkbox-item"><input type="checkbox" id="perda-peso-psiq"><label for="perda-peso-psiq">Perda de peso</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ganho-peso"><label for="ganho-peso">Ganho de peso</label></div>
        <div class="checkbox-item"><input type="checkbox" id="compuls-alim"><label for="compuls-alim">Compuls√£o alimentar</label></div>
        <div class="checkbox-item"><input type="checkbox" id="restric-alim"><label for="restric-alim">Restri√ß√£o alimentar</label></div>
        <div class="checkbox-item"><input type="checkbox" id="purgacao"><label for="purgacao">Purga√ß√£o</label></div>
      </div>

      <div class="section-title">‚ö° 11. Energia e Psicomotricidade</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="fadiga-psiq"><label for="fadiga-psiq">Fadiga/cansa√ßo excessivo</label></div>
        <div class="checkbox-item"><input type="checkbox" id="anergia"><label for="anergia">Anergia (falta de energia)</label></div>
        <div class="checkbox-item"><input type="checkbox" id="agitacao-psicomotora"><label for="agitacao-psicomotora">Agita√ß√£o psicomotora</label></div>
        <div class="checkbox-item"><input type="checkbox" id="retardo-psicomotor"><label for="retardo-psicomotor">Retardo psicomotor</label></div>
        <div class="checkbox-item"><input type="checkbox" id="catatonia"><label for="catatonia">Sintomas catat√¥nicos</label></div>
        <div class="checkbox-item"><input type="checkbox" id="akathisia"><label for="akathisia">Acatisia</label></div>
      </div>

      <div class="section-title">üíÄ 12. Idea√ß√£o Suicida e Comportamento</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="ideacao-suicida"><label for="ideacao-suicida">Idea√ß√£o suicida passiva</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ideacao-ativa"><label for="ideacao-ativa">Idea√ß√£o suicida ativa</label></div>
        <div class="checkbox-item"><input type="checkbox" id="plano-suicida"><label for="plano-suicida">Plano suicida estruturado</label></div>
        <div class="checkbox-item"><input type="checkbox" id="tentativa-previa"><label for="tentativa-previa">Tentativa de suic√≠dio pr√©via</label></div>
        <div class="checkbox-item"><input type="checkbox" id="autolesao"><label for="autolesao">Comportamento autolesivo</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ideacao-homicida"><label for="ideacao-homicida">Idea√ß√£o homicida</label></div>
        <div class="checkbox-item"><input type="checkbox" id="impulsividade"><label for="impulsividade">Impulsividade aumentada</label></div>
        <div class="checkbox-item"><input type="checkbox" id="agressividade"><label for="agressividade">Agressividade</label></div>
      </div>

      <div class="section-title">üë• 13. Funcionamento Social e Ocupacional</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="isolamento-social"><label for="isolamento-social">Isolamento social</label></div>
        <div class="checkbox-item"><input type="checkbox" id="prejuizo-trab"><label for="prejuizo-trab">Preju√≠zo no trabalho/estudos</label></div>
        <div class="checkbox-item"><input type="checkbox" id="conflitos-fam"><label for="conflitos-fam">Conflitos familiares</label></div>
        <div class="checkbox-item"><input type="checkbox" id="conflitos-inter"><label for="conflitos-inter">Dificuldades interpessoais</label></div>
        <div class="checkbox-item"><input type="checkbox" id="perda-autonomia"><label for="perda-autonomia">Perda de autonomia</label></div>
        <div class="checkbox-item"><input type="checkbox" id="negligencia-auto"><label for="negligencia-auto">Neglig√™ncia com autocuidado</label></div>
      </div>

      <div class="section-title">üíä 14. Uso de Subst√¢ncias</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="uso-alcool-psiq"><label for="uso-alcool-psiq">Uso de √°lcool</label></div>
        <div class="checkbox-item"><input type="checkbox" id="depend-alcool"><label for="depend-alcool">Depend√™ncia de √°lcool</label></div>
        <div class="checkbox-item"><input type="checkbox" id="uso-tabaco-psiq"><label for="uso-tabaco-psiq">Uso de tabaco</label></div>
        <div class="checkbox-item"><input type="checkbox" id="uso-cannabis"><label for="uso-cannabis">Uso de cannabis</label></div>
        <div class="checkbox-item"><input type="checkbox" id="uso-cocaina"><label for="uso-cocaina">Uso de coca√≠na/crack</label></div>
        <div class="checkbox-item"><input type="checkbox" id="uso-anfeta"><label for="uso-anfeta">Uso de anfetaminas</label></div>
        <div class="checkbox-item"><input type="checkbox" id="uso-benzod"><label for="uso-benzod">Uso de benzodiazep√≠nicos</label></div>
        <div class="checkbox-item"><input type="checkbox" id="uso-opioides"><label for="uso-opioides">Uso de opioides</label></div>
        <div class="checkbox-item"><input type="checkbox" id="uso-outras"><label for="uso-outras">Outras subst√¢ncias</label></div>
        <div class="checkbox-item"><input type="checkbox" id="abstinencia"><label for="abstinencia">S√≠ndrome de abstin√™ncia</label></div>
      </div>

      <div class="section-title">üß¨ 15. Antecedentes Psiqui√°tricos Pessoais</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="ant-depressao"><label for="ant-depressao">Depress√£o pr√©via</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ant-mania"><label for="ant-mania">Mania/hipomania pr√©via</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ant-psicose"><label for="ant-psicose">Epis√≥dio psic√≥tico pr√©vio</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ant-ansiedade"><label for="ant-ansiedade">Transtorno de ansiedade pr√©vio</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ant-toc-prev"><label for="ant-toc-prev">TOC pr√©vio</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ant-tept"><label for="ant-tept">TEPT pr√©vio</label></div>
        <div class="checkbox-item"><input type="checkbox" id="ant-aliment"><label for="ant-aliment">Transtorno alimentar pr√©vio</label></div>
        <div class="checkbox-item"><input type="checkbox" id="internan-psiq"><label for="internan-psiq">Interna√ß√£o psiqui√°trica pr√©via</label></div>
      </div>

      <div class="section-title">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ 16. Antecedentes Familiares Psiqui√°tricos</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="fam-depressao"><label for="fam-depressao">Depress√£o na fam√≠lia</label></div>
        <div class="checkbox-item"><input type="checkbox" id="fam-bipolar"><label for="fam-bipolar">Transtorno bipolar na fam√≠lia</label></div>
        <div class="checkbox-item"><input type="checkbox" id="fam-esquizo"><label for="fam-esquizo">Esquizofrenia na fam√≠lia</label></div>
        <div class="checkbox-item"><input type="checkbox" id="fam-suicidio"><label for="fam-suicidio">Suic√≠dio na fam√≠lia</label></div>
        <div class="checkbox-item"><input type="checkbox" id="fam-alcool"><label for="fam-alcool">Alcoolismo na fam√≠lia</label></div>
        <div class="checkbox-item"><input type="checkbox" id="fam-drogas"><label for="fam-drogas">Depend√™ncia qu√≠mica na fam√≠lia</label></div>
      </div>

      <div class="section-title">üíä 17. Medica√ß√µes Psiqui√°tricas Atuais/Pr√©vias</div>
      <textarea id="psiq-meds" rows="4" placeholder="Liste medica√ß√µes psiqui√°tricas em uso ou j√° utilizadas (nome, dose, tempo de uso, resposta, efeitos colaterais)..."></textarea>

      <div class="section-title">üßò 18. Tratamentos Pr√©vios</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="trat-psicoterapia"><label for="trat-psicoterapia">Psicoterapia pr√©via</label></div>
        <div class="checkbox-item"><input type="checkbox" id="trat-tcc"><label for="trat-tcc">TCC (Terapia Cognitivo-Comportamental)</label></div>
        <div class="checkbox-item"><input type="checkbox" id="trat-psicanalise"><label for="trat-psicanalise">Psican√°lise</label></div>
        <div class="checkbox-item"><input type="checkbox" id="trat-grupo"><label for="trat-grupo">Terapia em grupo</label></div>
        <div class="checkbox-item"><input type="checkbox" id="trat-ect"><label for="trat-ect">Eletroconvulsoterapia (ECT)</label></div>
      </div>

      <div class="section-title">üë∂ 19. Hist√≥ria do Desenvolvimento</div>
      <textarea id="psiq-desenvolvimento" rows="3" placeholder="Gesta√ß√£o, parto, desenvolvimento neuropsicomotor, marcos do desenvolvimento..."></textarea>

      <div class="section-title">üè† 20. Hist√≥ria Pessoal e Social</div>
      <textarea id="psiq-historia-social" rows="4" placeholder="Inf√¢ncia, escolaridade, relacionamentos, trabalho, traumas, eventos estressantes, suporte social, estrutura familiar..."></textarea>

      <div class="section-title">‚öñÔ∏è 21. Quest√µes M√©dico-Legais</div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="judicializacao"><label for="judicializacao">Processo judicial em andamento</label></div>
        <div class="checkbox-item"><input type="checkbox" id="interdicao"><label for="interdicao">Interdi√ß√£o/curatela</label></div>
        <div class="checkbox-item"><input type="checkbox" id="medida-protet"><label for="medida-protet">Medida protetiva</label></div>
        <div class="checkbox-item"><input type="checkbox" id="hist-forense"><label for="hist-forense">Hist√≥ria forense</label></div>
      </div>

      <div class="section-title">üìù 22. Observa√ß√µes Adicionais</div>
      <textarea id="psiq-obs" rows="3" placeholder="Outras informa√ß√µes relevantes..."></textarea>
    </div>
    <!-- ============ FIM SE√á√ÉO PSIQUIATRIA ============ -->

      <button class="btn-generate" onclick="gerarRelatorio()">GERAR EVOLU√á√ÉO</button>
      <button class="btn-reset" onclick="limparTudo()">LIMPAR TUDO</button>
    </div>
  </div>

  <div id="modalResultado" class="modal">
    <div class="modal-content">
      <h2 style="color:var(--primary); text-align:center; margin-bottom:10px;">Relat√≥rio Final</h2>
      <textarea id="finalReport" readonly></textarea>
      <div class="modal-actions">
        <button class="btn-modal btn-copy" onclick="copiar()">Copiar Texto</button>
        <button class="btn-modal" style="background:#4caf50;" onclick="salvarAnamneseAtual()">üíæ Salvar Anamnese</button>
        <button class="btn-modal btn-pdf" onclick="salvarPDF()">Salvar PDF</button>
        <button class="btn-modal btn-close" onclick="fecharModal()">Fechar / Editar</button>
      </div>
    </div>
  </div>

<!-- Bot√£o flutuante Scores -->
<button id="btn-scores-flutuante" type="button" onclick="abrirScores()">
  Scores
</button>

<!-- Fundo escuro do modal -->
<div id="modal-scores-backdrop" onclick="fecharScores()"></div>

<!-- Modal com os scores -->
<div id="modal-scores">
  <span class="fechar" onclick="fecharScores()">‚úï</span>
  <h2>Scores</h2>

  <!-- CURB-65 -->
  <section>
    <h3>CURB-65</h3>

    <label>
      <input type="checkbox" id="curb-confusao">
      Confus√£o mental aguda
    </label>

    <label>
      <input type="checkbox" id="curb-ureia">
      Ureia/BUN elevado (‚â• 7 mmol/L ou ‚â• 20 mg/dL)
    </label>

    <label>
      <input type="checkbox" id="curb-fr30">
      FR ‚â• 30 irpm
    </label>

    <label>
      <input type="checkbox" id="curb-pa">
      PAS &lt; 90 mmHg ou PAD ‚â§ 60 mmHg
    </label>

    <label>
      <input type="checkbox" id="curb-idade65">
      Idade ‚â• 65 anos
    </label>

    <button type="button" onclick="atualizaCURB65()">Calcular CURB-65</button>
    <p id="curb-resultado"></p>
  </section>

  <!-- Glasgow -->
  <section>
    <h3>Escala de Glasgow</h3>

    <label>Abertura ocular (E)</label>
    <select id="gcs-ocular" onchange="atualizaGCS()">
      <option value="4">4 - Espont√¢nea</option>
      <option value="3">3 - Ao chamado</option>
      <option value="2">2 - √Ä dor</option>
      <option value="1">1 - Nenhuma</option>
    </select>

    <label>Resposta verbal (V)</label>
    <select id="gcs-verbal" onchange="atualizaGCS()">
      <option value="5">5 - Orientado</option>
      <option value="4">4 - Confuso</option>
      <option value="3">3 - Palavras inapropriadas</option>
      <option value="2">2 - Sons incompreens√≠veis</option>
      <option value="1">1 - Nenhuma</option>
    </select>

    <label>Resposta motora (M)</label>
    <select id="gcs-motora" onchange="atualizaGCS()">
      <option value="6">6 - Obedece comandos</option>
      <option value="5">5 - Localiza dor</option>
      <option value="4">4 - Retirada √† dor</option>
      <option value="3">3 - Flex√£o anormal</option>
      <option value="2">2 - Extens√£o anormal</option>
      <option value="1">1 - Nenhuma</option>
    </select>

    <button type="button" onclick="atualizaGCS()">Calcular Glasgow</button>
    <p id="gcs-resultado"></p>
  </section>

  <!-- TIMI Score -->
  <section>
    <h3>TIMI Score (S√≠ndrome Coronariana Aguda)</h3>

    <label>
      <input type="checkbox" id="timi-idade">
      Idade ‚â• 65 anos
    </label>

    <label>
      <input type="checkbox" id="timi-fatores">
      ‚â• 3 fatores de risco (HAS, DM, tabagismo, dislipidemia, hist√≥ria familiar)
    </label>

    <label>
      <input type="checkbox" id="timi-estenose">
      Estenose coronariana conhecida ‚â• 50%
    </label>

    <label>
      <input type="checkbox" id="timi-aspirina">
      Uso de AAS nos √∫ltimos 7 dias
    </label>

    <label>
      <input type="checkbox" id="timi-angina">
      ‚â• 2 epis√≥dios de angina nas √∫ltimas 24h
    </label>

    <label>
      <input type="checkbox" id="timi-st">
      Desvio do segmento ST ‚â• 0,5 mm
    </label>

    <label>
      <input type="checkbox" id="timi-marcadores">
      Marcadores card√≠acos elevados (troponina, CK-MB)
    </label>

    <button type="button" onclick="atualizaTIMI()">Calcular TIMI</button>
    <p id="timi-resultado"></p>
  </section>

  <!-- SOFA Score -->
  <section>
    <h3>SOFA Score (Disfun√ß√£o Org√¢nica)</h3>

    <label>PaO2/FiO2 ou SatO2/FiO2</label>
    <select id="sofa-resp">
      <option value="0">‚â• 400 (normal)</option>
      <option value="1">300-399</option>
      <option value="2">200-299</option>
      <option value="3">100-199 (VM)</option>
      <option value="4">&lt; 100 (VM)</option>
    </select>

    <label>Plaquetas (√ó10¬≥/ŒºL)</label>
    <select id="sofa-plaq">
      <option value="0">‚â• 150</option>
      <option value="1">100-149</option>
      <option value="2">50-99</option>
      <option value="3">20-49</option>
      <option value="4">&lt; 20</option>
    </select>

    <label>Bilirrubina (mg/dL)</label>
    <select id="sofa-bili">
      <option value="0">&lt; 1.2</option>
      <option value="1">1.2-1.9</option>
      <option value="2">2.0-5.9</option>
      <option value="3">6.0-11.9</option>
      <option value="4">‚â• 12.0</option>
    </select>

    <label>PAM ou uso de vasopressores</label>
    <select id="sofa-cv">
      <option value="0">PAM ‚â• 70 mmHg</option>
      <option value="1">PAM &lt; 70 mmHg</option>
      <option value="2">Dopamina ‚â§ 5 ou dobutamina</option>
      <option value="3">Dopamina &gt; 5 ou Nora ‚â§ 0.1</option>
      <option value="4">Dopamina &gt; 15 ou Nora &gt; 0.1</option>
    </select>

    <label>Escala de Glasgow</label>
    <select id="sofa-neuro">
      <option value="0">15</option>
      <option value="1">13-14</option>
      <option value="2">10-12</option>
      <option value="3">6-9</option>
      <option value="4">&lt; 6</option>
    </select>

    <label>Creatinina (mg/dL) ou d√©bito urin√°rio</label>
    <select id="sofa-renal">
      <option value="0">&lt; 1.2</option>
      <option value="1">1.2-1.9</option>
      <option value="2">2.0-3.4</option>
      <option value="3">3.5-4.9 ou DU &lt; 500ml/dia</option>
      <option value="4">‚â• 5.0 ou DU &lt; 200ml/dia</option>
    </select>

    <button type="button" onclick="atualizaSOFA()">Calcular SOFA</button>
    <p id="sofa-resultado"></p>
  </section>

  <!-- Wells Score (TVP) -->
  <section>
    <h3>Wells Score (Trombose Venosa Profunda)</h3>

    <label>
      <input type="checkbox" id="wells-cancer">
      C√¢ncer ativo (+1)
    </label>

    <label>
      <input type="checkbox" id="wells-paralisia">
      Paralisia, paresia ou imobiliza√ß√£o recente de MMII (+1)
    </label>

    <label>
      <input type="checkbox" id="wells-leito">
      Restri√ß√£o ao leito &gt; 3 dias ou cirurgia &lt; 12 semanas (+1)
    </label>

    <label>
      <input type="checkbox" id="wells-dor">
      Dor localizada ao longo do sistema venoso profundo (+1)
    </label>

    <label>
      <input type="checkbox" id="wells-edema">
      Edema de toda a perna (+1)
    </label>

    <label>
      <input type="checkbox" id="wells-panturrilha">
      Circunfer√™ncia da panturrilha &gt; 3cm que o lado assintom√°tico (+1)
    </label>

    <label>
      <input type="checkbox" id="wells-cacifo">
      Edema com cacifo (mais na perna sintom√°tica) (+1)
    </label>

    <label>
      <input type="checkbox" id="wells-veias">
      Veias superficiais colaterais (n√£o varicosas) (+1)
    </label>

    <label>
      <input type="checkbox" id="wells-tvp-previa">
      TVP pr√©via documentada (+1)
    </label>

    <label>
      <input type="checkbox" id="wells-alternativo">
      Diagn√≥stico alternativo t√£o ou mais prov√°vel que TVP (-2)
    </label>

    <button type="button" onclick="atualizaWells()">Calcular Wells</button>
    <p id="wells-resultado"></p>
  </section>

  <!-- CHA2DS2-VASc Score -->
  <section>
    <h3>CHA2DS2-VASc (Risco de AVC em FA)</h3>

    <label>
      <input type="checkbox" id="cha2-chf">
      Insufici√™ncia Card√≠aca Congestiva (+1)
    </label>

    <label>
      <input type="checkbox" id="cha2-has">
      Hipertens√£o (+1)
    </label>

    <label>
      <input type="checkbox" id="cha2-idade75">
      Idade ‚â• 75 anos (+2)
    </label>

    <label>
      <input type="checkbox" id="cha2-dm">
      Diabetes Mellitus (+1)
    </label>

    <label>
      <input type="checkbox" id="cha2-avc">
      AVC/AIT/Tromboembolismo pr√©vio (+2)
    </label>

    <label>
      <input type="checkbox" id="cha2-vasc">
      Doen√ßa vascular (IAM, placa a√≥rtica, DAP) (+1)
    </label>

    <label>
      <input type="checkbox" id="cha2-idade65">
      Idade 65-74 anos (+1)
    </label>

    <label>
      <input type="checkbox" id="cha2-sexo">
      Sexo feminino (+1)
    </label>

    <button type="button" onclick="atualizaCHA2DS2VASc()">Calcular CHA2DS2-VASc</button>
    <p id="cha2-resultado"></p>
  </section>

  <!-- HAS-BLED Score -->
  <section>
    <h3>HAS-BLED (Risco de Sangramento)</h3>

    <label>
      <input type="checkbox" id="hasbled-has">
      Hipertens√£o n√£o controlada (PAS &gt; 160) (+1)
    </label>

    <label>
      <input type="checkbox" id="hasbled-renal">
      Fun√ß√£o renal anormal (di√°lise, Cr &gt; 2.6) (+1)
    </label>

    <label>
      <input type="checkbox" id="hasbled-hepat">
      Fun√ß√£o hep√°tica anormal (+1)
    </label>

    <label>
      <input type="checkbox" id="hasbled-avc">
      AVC pr√©vio (+1)
    </label>

    <label>
      <input type="checkbox" id="hasbled-sangra">
      Hist√≥ria de sangramento (+1)
    </label>

    <label>
      <input type="checkbox" id="hasbled-inr">
      INR l√°bil (< 60% no alvo) (+1)
    </label>

    <label>
      <input type="checkbox" id="hasbled-idade">
      Idade &gt; 65 anos (+1)
    </label>

    <label>
      <input type="checkbox" id="hasbled-drogas">
      Drogas (antiagregantes, AINEs) ou √°lcool (+1)
    </label>

    <button type="button" onclick="atualizaHASBLED()">Calcular HAS-BLED</button>
    <p id="hasbled-resultado"></p>
  </section>
</div>

  <script>

    // ============ DARK MODE ============
    function toggleDarkMode() {
      const body = document.body;
      const btn = document.getElementById('btnDarkMode');
      
      body.classList.toggle('dark-mode');
      
      if (body.classList.contains('dark-mode')) {
        btn.innerHTML = '‚òÄÔ∏è Modo Claro';
        localStorage.setItem('darkMode', 'enabled');
      } else {
        btn.innerHTML = 'üåô Modo Escuro';
        localStorage.setItem('darkMode', 'disabled');
      }
    }

    // Carregar prefer√™ncia de dark mode
    window.addEventListener('DOMContentLoaded', function() {
      const darkMode = localStorage.getItem('darkMode');
      const btn = document.getElementById('btnDarkMode');
      
      if (darkMode === 'enabled') {
        document.body.classList.add('dark-mode');
        if(btn) btn.innerHTML = '‚òÄÔ∏è Modo Claro';
      }
    });

    // ============ BACKUP/EXPORTAR/IMPORTAR ============
    function toggleMenuBackup() {
      const menu = document.getElementById('menuBackup');
      menu.style.display = menu.style.display === 'none' ? 'block' : 'none';
    }

    // Fechar menu ao clicar fora
    document.addEventListener('click', function(e) {
      const menu = document.getElementById('menuBackup');
      const btn = document.getElementById('btnBackup');
      if (menu && btn && !menu.contains(e.target) && !btn.contains(e.target)) {
        menu.style.display = 'none';
      }
    });

    function exportarDados() {
      try {
        // Pegar hist√≥rico
        const historico = localStorage.getItem('anamnese_historico') || '[]';
        const credenciais = localStorage.getItem('anamnese_credentials') || '{}';
        
        const backup = {
          version: '1.0',
          timestamp: new Date().toISOString(),
          data: {
            historico: JSON.parse(historico),
            credenciais: JSON.parse(credenciais)
          }
        };

        const dataStr = JSON.stringify(backup, null, 2);
        const blob = new Blob([dataStr], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        
        const link = document.createElement('a');
        const filename = `anamnese-backup-${new Date().toISOString().split('T')[0]}.json`;
        link.href = url;
        link.download = filename;
        link.click();
        
        URL.revokeObjectURL(url);
        alert('‚úÖ Backup exportado com sucesso!');
        toggleMenuBackup();
      } catch (e) {
        alert('‚ùå Erro ao exportar backup: ' + e.message);
      }
    }

    function importarDados(event) {
      const file = event.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const backup = JSON.parse(e.target.result);
          
          if (!backup.data || !backup.data.historico) {
            throw new Error('Arquivo de backup inv√°lido');
          }

          if (!confirm('‚ö†Ô∏è Isso substituir√° todos os dados atuais. Deseja continuar?')) {
            return;
          }

          // Restaurar dados
          localStorage.setItem('anamnese_historico', JSON.stringify(backup.data.historico));
          
          if (backup.data.credenciais && backup.data.credenciais.usuario) {
            localStorage.setItem('anamnese_credentials', JSON.stringify(backup.data.credenciais));
          }

          alert('‚úÖ Backup importado com sucesso! A p√°gina ser√° recarregada.');
          location.reload();
        } catch (e) {
          alert('‚ùå Erro ao importar backup: ' + e.message);
        }
      };
      reader.readAsText(file);
      
      // Limpar input
      event.target.value = '';
      toggleMenuBackup();
    }

    // ============ ATALHOS DE TECLADO ============
    document.addEventListener('keydown', function(e) {
      // Ctrl+S: Salvar paciente
      if (e.ctrlKey && e.key === 's') {
        e.preventDefault();
        if (typeof window.salvarPacienteAtual === 'function') {
          window.salvarPacienteAtual();
        }
      }
      
      // Ctrl+G: Gerar relat√≥rio
      if (e.ctrlKey && e.key === 'g') {
        e.preventDefault();
        if (typeof gerarRelatorio === 'function') {
          gerarRelatorio();
        }
      }
      
      // Ctrl+H: Abrir hist√≥rico
      if (e.ctrlKey && e.key === 'h') {
        e.preventDefault();
        if (typeof window.abrirHistorico === 'function') {
          window.abrirHistorico();
        }
      }
      
      // Ctrl+E: Abrir scores
      if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        if (typeof abrirScores === 'function') {
          abrirScores();
        }
      }
      
      // Esc: Fechar modais
      if (e.key === 'Escape') {
        const modalResultado = document.getElementById('modalResultado');
        const modalHistorico = document.getElementById('modalHistorico');
        const modalScores = document.getElementById('modal-scores');
        const modalEsp = document.getElementById('modalEspecialidades');
        
        if (modalResultado && modalResultado.style.display === 'flex') {
          fecharModal();
        }
        if (modalHistorico && modalHistorico.classList.contains('show')) {
          window.fecharHistorico();
        }
        if (modalScores && modalScores.style.display === 'block') {
          fecharScores();
        }
        if (modalEsp && modalEsp.classList.contains('active')) {
          fecharModalEspecialidades();
        }
      }
    });

    // ============ FUN√á√ïES ESPECIALIDADES ============
    function abrirModalEspecialidades() {
      document.getElementById('modalEspecialidades').classList.add('active');
    }

    function fecharModalEspecialidades() {
      document.getElementById('modalEspecialidades').classList.remove('active');
    }

    function selecionarEspecialidade(tipo) {
      document.querySelectorAll('.secao-especializada').forEach(s => s.classList.remove('active'));

      if (tipo === 'gastro') {
        document.getElementById('secao-gastro').classList.add('active');
        setTimeout(() => {
          const elem = document.getElementById('secao-gastro');
          if(elem) elem.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }, 100);
      } else if (tipo === 'psiq') {
        document.getElementById('secao-psiq').classList.add('active');
        setTimeout(() => {
          const elem = document.getElementById('secao-psiq');
          if(elem) elem.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }, 100);
      }

      fecharModalEspecialidades();
    }

    function toggleDorAbdominal() {
      const checked = document.getElementById('dor-abdominal').checked;
      document.getElementById('dor-abdominal-detalhes').style.display = checked ? 'block' : 'none';
    }

    function toggleVomitos() {
      const checked = document.getElementById('vomitos').checked;
      document.getElementById('vomitos-detalhes').style.display = checked ? 'block' : 'none';
    }

    function toggleDisfagia() {
      const checked = document.getElementById('disfagia').checked;
      document.getElementById('disfagia-detalhes').style.display = checked ? 'block' : 'none';
    }

    function toggleDiarreia() {
      const checked = document.getElementById('diarreia').checked;
      document.getElementById('diarreia-detalhes').style.display = checked ? 'block' : 'none';
    }

    function toggleEtilismoGastro() {
      const checked = document.getElementById('hab-etil').checked;
      document.getElementById('etilismo-detalhes-gastro').style.display = checked ? 'block' : 'none';
    }

    window.addEventListener('load', function() {
      const modalEsp = document.getElementById('modalEspecialidades');
      if(modalEsp) {
        modalEsp.addEventListener('click', function(e) {
          if (e.target === this) {
            fecharModalEspecialidades();
          }
        });
      }
    });

    const state = {
      alergias: "N√£o",
      internacao: "N√£o",
      tabagismo: "N√£o",
      etilismo: "N√£o",
      drogas: "N√£o"
    };
    const alertTypes = new Set(["alergias","internacao","tabagismo","etilismo","drogas"]);

    // ============ ARMAZENAMENTO DE SCORES CALCULADOS ============
    const scoresCalculados = {};

    function salvarScore(nome, pontuacao, interpretacao) {
      scoresCalculados[nome] = {
        pontuacao: pontuacao,
        interpretacao: interpretacao,
        timestamp: new Date().toLocaleString('pt-BR')
      };
    }

    function limparScores() {
      Object.keys(scoresCalculados).forEach(key => delete scoresCalculados[key]);
    }

    function obterScoresTexto() {
      const keys = Object.keys(scoresCalculados);
      if (keys.length === 0) return "";
      
      let texto = "\n# SCORES CL√çNICOS CALCULADOS #\n";
      keys.forEach(nome => {
        const score = scoresCalculados[nome];
        texto += `\n**${nome}:**\n`;
        texto += `  Pontua√ß√£o: ${score.pontuacao}\n`;
        texto += `  Interpreta√ß√£o: ${score.interpretacao}\n`;
        texto += `  Calculado em: ${score.timestamp}\n`;
      });
      return texto;
    }

    function setOption(type, value){
      state[type] = value;
      const group = document.getElementById(type + "-group");
      const btns = group.getElementsByClassName("toggle-btn");
      Array.from(btns).forEach(b => {
        b.classList.remove("active");
        b.classList.remove("alert-active");
        if (b.innerText.trim().toUpperCase() === value.toUpperCase()){
          b.classList.add("active");
          if (value === "Sim" && alertTypes.has(type)) b.classList.add("alert-active");
        }
      });

      const detail = document.getElementById(type + "-detalhe");
      if (detail){
        detail.style.display = (value === "Sim") ? "block" : "none";
        if (value !== "Sim") detail.value = "";
        if (value === "Sim") detail.focus();
      }

      if (type === "tabagismo"){
        const calcDiv = document.getElementById("tabagismo-calc");
        if (calcDiv){
          calcDiv.style.display = (value === "Sim") ? "block" : "none";
          if (value !== "Sim"){
            document.getElementById("tab_cigs_dia").value = "";
            document.getElementById("tab_anos").value = "";
            document.getElementById("tab_carga").innerText = "0";
          }
        }
      }
    }

    function v(id){
      const el = document.getElementById(id);
      return (el && el.value) ? el.value.trim() : "";
    }

    function calcularCargaTabagica(){
      const cigs = parseFloat(document.getElementById("tab_cigs_dia")?.value || "0");
      const anos = parseFloat(document.getElementById("tab_anos")?.value || "0");
      const span = document.getElementById("tab_carga");
      if (!span){
        return 0;
      }
      if (isNaN(cigs) || isNaN(anos) || cigs <= 0 || anos <= 0){
        span.innerText = "0";
        return 0;
      }
      const carga = (cigs / 20) * anos;
      const cargaFmt = carga.toFixed(1);
      span.innerText = cargaFmt;
      return carga;
    }

    const templates = {
      M: {
        ef_ectoscopia: "REG, regular estado nutricional, mucosas coradas e hidratadas, afebril, acian√≥tico, anict√©rico, l√∫cido e orientado (alo e autops√≠quico) em tempo e espa√ßo, comunicativo, eupneico, f√°cies at√≠pica.",
        ef_cp: "aus√™ncia de linfonodomegalias palp√°veis, aus√™ncia de turg√™ncia jugular, n√£o ausculto sopros carot√≠deos.",
        ef_acv: "RCR, BNF em 2T, sem sopros aud√≠veis. Ictus cordis n√£o palp√°vel. Pulsos presentes, amplos e sim√©tricos. TEC < 3s.",
        ef_ap: "MV+ bilateralamente aud√≠vel, sem ru√≠dos advent√≠cios. T√≥rax at√≠pico. Eupneico. Sem sinais de esfor√ßo.",
        ef_abd: "plano, fl√°cido, normotenso, sem visceromegalias, indolor, RHA+, DB negativa, sem peritonite.",
        ef_neuro: "ECG 15, pupilas isoc√≥ricas e fotorreagentes, MOE preservada, face sim√©trica, sem d√©ficits focais agudos, for√ßa e sensibilidade preservadas, coordena√ß√£o normal.",
        ef_membros: "sem edemas, panturrilhas livres, TEC < 3 segs.",
        neuro_detalhado: `N√≠vel de Consci√™ncia: Vigil e desperto, auto e alo orientado
Fala e linguagem preservadas, aus√™ncia de afasia e disartria.

Nervos cranianos: Pupilas isoc√≥ricas e fotorreagentes, MOE preservada, campimetria normal, face sim√©trica.

Motricidade: T√¥nus e trofismo preservado, for√ßa grau V global.

Sensibilidade: t√°til, t√©rmica, dolorosa e vibrat√≥ria preservadas.

Reflexos: grau 2 sim√©tricos. Cutaneoplantar em flex√£o bilateral.

Coordena√ß√£o: Eum√©trica. Romberg negativo. Sem sinais men√≠ngeos.`
      },
      F: {
        ef_ectoscopia: "REG, regular estado nutricional, mucosas coradas e hidratadas, afebril, acian√≥tica, anict√©rica, l√∫cida e orientada (alo e autops√≠quica) em tempo e espa√ßo, comunicativa, eupneica, f√°cies at√≠pica.",
        ef_cp: "aus√™ncia de linfonodomegalias palp√°veis, aus√™ncia de turg√™ncia jugular, n√£o ausculto sopros carot√≠deos.",
        ef_acv: "RCR, BNF em 2T, sem sopros aud√≠veis. Ictus cordis n√£o palp√°vel. Pulsos presentes, amplos e sim√©tricos. TEC < 3s.",
        ef_ap: "MV+ bilateralamente aud√≠vel, sem ru√≠dos advent√≠cios. T√≥rax at√≠pico. Eupneica. Sem sinais de esfor√ßo.",
        ef_abd: "plano, fl√°cido, normotenso, sem visceromegalias, indolor, RHA+, DB negativa, sem peritonite.",
        ef_neuro: "ECG 15, pupilas isoc√≥ricas e fotorreagentes, MOE preservada, face sim√©trica, sem d√©ficits focais agudos, for√ßa e sensibilidade preservadas, coordena√ß√£o normal.",
        ef_membros: "sem edemas, panturrilhas livres, TEC < 3 segs.",
        neuro_detalhado: `N√≠vel de Consci√™ncia: Vigil e desperta, auto e alo orientada
Fala e linguagem preservadas, aus√™ncia de afasia e disartria.

Nervos cranianos: Pupilas isoc√≥ricas e fotorreagentes, MOE preservada, campimetria normal, face sim√©trica.

Motricidade: T√¥nus e trofismo preservado, for√ßa grau V global.

Sensibilidade: t√°til, t√©rmica, dolorosa e vibrat√≥ria preservadas.

Reflexos: grau 2 sim√©tricos. Cutaneoplantar em flex√£o bilateral.

Coordena√ß√£o: Eum√©trica. Romberg negativo. Sem sinais men√≠ngeos.`
      }
    };

    const lastAuto = {};

    function initLastAuto(sexo){
      const t = templates[sexo] || templates.M;
      Object.keys(t).forEach(id => {
        const el = document.getElementById(id);
        if (!el) return;
        lastAuto[id] = (el.value || "").trim();
      });
    }

    function aplicarGenero(sexo){
      const t = templates[sexo] || templates.M;
      Object.keys(t).forEach(id => {
        const el = document.getElementById(id);
        if (!el) return;
        const atual = (el.value || "").trim();
        const anterior = (lastAuto[id] || "").trim();
        if (atual === "" || atual === anterior){
          el.value = t[id];
          lastAuto[id] = t[id];
        }
      });
    }

    document.getElementById("sexo").addEventListener("change", (e) => {
      aplicarGenero(e.target.value);
    });

    function pad2(n){ return String(n).padStart(2, "0"); }

    function ensureMedsPrefix(){
      const ta = document.getElementById("meds_continuos");
      if (!ta) return;
      if (ta.value.trim() === "") ta.value = "01 - ";
    }

    function nextMedsIndex(text){
      const matches = text.match(/^(\d{2})\s*-\s*/gm);
      if (!matches || matches.length === 0) return 1;
      const last = matches[matches.length - 1];
      const n = parseInt(last, 10);
      return isNaN(n) ? (matches.length + 1) : (n + 1);
    }

    function handleMedsEnter(e){
      if (e.key !== "Enter") return;
      e.preventDefault();
      const ta = e.target;
      const start = ta.selectionStart;
      const end = ta.selectionEnd;
      const before = ta.value.slice(0, start);
      const after = ta.value.slice(end);
      const idx = nextMedsIndex(before);
      const insert = `\n${pad2(idx)} - `;
      ta.value = before + insert + after;
      const caret = (before + insert).length;
      ta.selectionStart = ta.selectionEnd = caret;
    }

    function initMedsField(){
      const ta = document.getElementById("meds_continuos");
      if (!ta) return;
      ensureMedsPrefix();
      ta.addEventListener("focus", ensureMedsPrefix);
      ta.addEventListener("keydown", handleMedsEnter);
    }

    function yesNoBoldLine(label, type){
      const valYN = state[type] === "Sim" ? "SIM" : "N√ÉO";
      const det = v(type + "-detalhe");
      return `**${label}: ${valYN}${det ? " ‚Äî " + det : ""}**`;
    }

    function habitLine(label, type){
      const sim = state[type] === "Sim";
      const det = v(type + "-detalhe");
      const yn = sim ? "**SIM**" : "N√ÉO";

      if (type === "tabagismo" && sim){
        const carga = calcularCargaTabagica();
        const extra = carga > 0 ? `, carga tab√°gica: ${carga.toFixed(1)} ma√ßos-ano` : "";
        return `${label}: ${yn}${det ? " (" + det + ")" : ""}${extra}`;
      }

      return `${label}: ${yn}${det ? " (" + det + ")" : ""}`;
    }

function capturarDadosGastro() {
  const linhas = [];
  const gastroAtiva = document.getElementById('secao-gastro')?.classList.contains('active');
  if (!gastroAtiva) return linhas;
  
  linhas.push("");
  linhas.push("# ANAMNESE - GASTROENTEROLOGIA #");
  linhas.push("");
  
  function getChecked(ids) {
    return ids.filter(id => document.getElementById(id)?.checked)
              .map(id => document.querySelector('label[for="' + id + '"]')?.textContent || id);
  }
  
  if (document.getElementById('dor-abdominal')?.checked) {
    linhas.push("**DOR ABDOMINAL:**");
    const locs = getChecked(['loc-epigastrio','loc-hd','loc-he','loc-peri','loc-fid','loc-fie','loc-difusa']);
    if (locs.length > 0) linhas.push("  Localiza√ß√£o: " + locs.join(", "));
    const tipos = getChecked(['tipo-queimacao','tipo-colica','tipo-peso','tipo-pontada']);
    if (tipos.length > 0) linhas.push("  Tipo: " + tipos.join(", "));
    linhas.push("");
  }
  
  const altos = getChecked(['azia','regurg','nauseas','odinofagia','saciedade','plenitude']);
  if (altos.length > 0) {
    linhas.push("**SINTOMAS DIGESTIVOS ALTOS:** " + altos.join(", "));
    linhas.push("");
  }
  
  const baixos = getChecked(['constipacao','alternancia','tenesmo','urgencia']);
  if (baixos.length > 0) {
    linhas.push("**SINTOMAS DIGESTIVOS BAIXOS:** " + baixos.join(", "));
    linhas.push("");
  }
  
  const fezes = getChecked(['fezes-normais','fezes-pastosas','fezes-liquidas','fezes-duras','fezes-melena','fezes-sangue','fezes-muco','fezes-oleosas']);
  if (fezes.length > 0) {
    linhas.push("**CARACTER√çSTICAS DAS FEZES:** " + fezes.join(", "));
    linhas.push("");
  }
  
  return linhas;
}

function capturarDadosPsiq() {
  const linhas = [];
  const psiqAtiva = document.getElementById('secao-psiq')?.classList.contains('active');
  if (!psiqAtiva) return linhas;
  
  linhas.push("");
  linhas.push("# ANAMNESE - PSIQUIATRIA #");
  linhas.push("");
  
  function getChecked(ids) {
    return ids.filter(id => document.getElementById(id)?.checked)
              .map(id => document.querySelector('label[for="' + id + '"]')?.textContent || id);
  }
  
  function getTextarea(id) {
    const el = document.getElementById(id);
    return el && el.value ? el.value.trim() : "";
  }
  
  // Motivo da consulta
  const motivo = getTextarea('psiq-motivo');
  if (motivo) {
    linhas.push("**MOTIVO DA CONSULTA:**");
    linhas.push(motivo);
    linhas.push("");
  }
  
  // HDA Psiqui√°trica
  const hdaPsiq = getTextarea('psiq-hda');
  if (hdaPsiq) {
    linhas.push("**HIST√ìRIA DA DOEN√áA ATUAL (PSIQUI√ÅTRICA):**");
    linhas.push(hdaPsiq);
    linhas.push("");
  }
  
  // Humor e Afeto
  const humor = getChecked(['humor-deprimido','humor-elevado','humor-irritavel','humor-ansioso','humor-labil','humor-embotado','humor-inadequado','anedonia']);
  if (humor.length > 0) {
    linhas.push("**HUMOR E AFETO:** " + humor.join(", "));
    linhas.push("");
  }
  
  // Sintomas Ansiosos
  const ansiedade = getChecked(['ansiedade-geral','panico','fobias','fobia-social','agorafobia','toc','estresse-pos','preocup-excessiva','tensao-muscular','inquietacao']);
  if (ansiedade.length > 0) {
    linhas.push("**SINTOMAS ANSIOSOS:** " + ansiedade.join(", "));
    linhas.push("");
  }
  
  // Pensamento
  const pensamento = getChecked(['pensa-lento','pensa-acelerado','pensa-desorg','pensa-persev','ideias-delic','delic-perseg','delic-grandeza','delic-ruina','delic-culpa','pensa-magico','obsessoes','ruminacoes']);
  if (pensamento.length > 0) {
    linhas.push("**PENSAMENTO:** " + pensamento.join(", "));
    linhas.push("");
  }
  
  // Percep√ß√£o
  const percepcao = getChecked(['aluc-auditivas','aluc-visuais','aluc-tateis','aluc-olfativas','ilusoes','desperson','desreal']);
  if (percepcao.length > 0) {
    linhas.push("**PERCEP√á√ÉO:** " + percepcao.join(", "));
    linhas.push("");
  }
  
  // Orienta√ß√£o e Consci√™ncia
  const orientacao = getChecked(['orient-preserv','desorient-tempo','desorient-esp','desorient-pess','confusao-mental','rebaixa-consc']);
  if (orientacao.length > 0) {
    linhas.push("**ORIENTA√á√ÉO E CONSCI√äNCIA:** " + orientacao.join(", "));
    linhas.push("");
  }
  
  // Mem√≥ria e Cogni√ß√£o
  const memoria = getChecked(['mem-recente-alt','mem-remota-alt','amnesia','confabula','deficit-atenc','deficit-exec','deficit-linguagem']);
  if (memoria.length > 0) {
    linhas.push("**MEM√ìRIA E COGNI√á√ÉO:** " + memoria.join(", "));
    linhas.push("");
  }
  
  // Sono
  const sono = getChecked(['insonia-inicial','insonia-manut','insonia-terminal','hipersonia','pesadelos','terror-noturno','sono-nao-repousante']);
  if (sono.length > 0) {
    linhas.push("**SONO:** " + sono.join(", "));
    linhas.push("");
  }
  
  // Apetite
  const apetite = getChecked(['apetite-reduz','apetite-aument','perda-peso-psiq','ganho-peso','compuls-alim','restric-alim','purgacao']);
  if (apetite.length > 0) {
    linhas.push("**APETITE E ALIMENTA√á√ÉO:** " + apetite.join(", "));
    linhas.push("");
  }
  
  // Energia e Psicomotricidade
  const energia = getChecked(['fadiga-psiq','anergia','agitacao-psicomotora','retardo-psicomotor','catatonia','akathisia']);
  if (energia.length > 0) {
    linhas.push("**ENERGIA E PSICOMOTRICIDADE:** " + energia.join(", "));
    linhas.push("");
  }
  
  // Idea√ß√£o Suicida
  const suicida = getChecked(['ideacao-suicida','ideacao-ativa','plano-suicida','tentativa-previa','autolesao','ideacao-homicida','impulsividade','agressividade']);
  if (suicida.length > 0) {
    linhas.push("**‚ö†Ô∏è IDEA√á√ÉO SUICIDA E COMPORTAMENTO:** " + suicida.join(", "));
    linhas.push("");
  }
  
  // Funcionamento Social
  const social = getChecked(['isolamento-social','prejuizo-trab','conflitos-fam','conflitos-inter','perda-autonomia','negligencia-auto']);
  if (social.length > 0) {
    linhas.push("**FUNCIONAMENTO SOCIAL E OCUPACIONAL:** " + social.join(", "));
    linhas.push("");
  }
  
  // Uso de Subst√¢ncias
  const substancias = getChecked(['uso-alcool-psiq','depend-alcool','uso-tabaco-psiq','uso-cannabis','uso-cocaina','uso-anfeta','uso-benzod','uso-opioides','uso-outras','abstinencia']);
  if (substancias.length > 0) {
    linhas.push("**USO DE SUBST√ÇNCIAS:** " + substancias.join(", "));
    linhas.push("");
  }
  
  // Antecedentes Psiqui√°tricos
  const antPsiq = getChecked(['ant-depressao','ant-mania','ant-psicose','ant-ansiedade','ant-toc-prev','ant-tept','ant-aliment','internan-psiq']);
  if (antPsiq.length > 0) {
    linhas.push("**ANTECEDENTES PSIQUI√ÅTRICOS PESSOAIS:** " + antPsiq.join(", "));
    linhas.push("");
  }
  
  // Antecedentes Familiares
  const famPsiq = getChecked(['fam-depressao','fam-bipolar','fam-esquizo','fam-suicidio','fam-alcool','fam-drogas']);
  if (famPsiq.length > 0) {
    linhas.push("**ANTECEDENTES FAMILIARES PSIQUI√ÅTRICOS:** " + famPsiq.join(", "));
    linhas.push("");
  }
  
  // Medica√ß√µes Psiqui√°tricas
  const meds = getTextarea('psiq-meds');
  if (meds) {
    linhas.push("**MEDICA√á√ïES PSIQUI√ÅTRICAS:**");
    linhas.push(meds);
    linhas.push("");
  }
  
  // Tratamentos Pr√©vios
  const tratamentos = getChecked(['trat-psicoterapia','trat-tcc','trat-psicanalise','trat-grupo','trat-ect']);
  if (tratamentos.length > 0) {
    linhas.push("**TRATAMENTOS PR√âVIOS:** " + tratamentos.join(", "));
    linhas.push("");
  }
  
  // Hist√≥ria do Desenvolvimento
  const desenvolvimento = getTextarea('psiq-desenvolvimento');
  if (desenvolvimento) {
    linhas.push("**HIST√ìRIA DO DESENVOLVIMENTO:**");
    linhas.push(desenvolvimento);
    linhas.push("");
  }
  
  // Hist√≥ria Social
  const historiaSocial = getTextarea('psiq-historia-social');
  if (historiaSocial) {
    linhas.push("**HIST√ìRIA PESSOAL E SOCIAL:**");
    linhas.push(historiaSocial);
    linhas.push("");
  }
  
  // Quest√µes M√©dico-Legais
  const legal = getChecked(['judicializacao','interdicao','medida-protet','hist-forense']);
  if (legal.length > 0) {
    linhas.push("**QUEST√ïES M√âDICO-LEGAIS:** " + legal.join(", "));
    linhas.push("");
  }
  
  // Observa√ß√µes
  const obs = getTextarea('psiq-obs');
  if (obs) {
    linhas.push("**OBSERVA√á√ïES ADICIONAIS:**");
    linhas.push(obs);
    linhas.push("");
  }
  
  return linhas;
}

    function montarTextoRelatorioBase(){
      const linhas = [];
      linhas.push("## ADMISS√ÉO / EVOLU√á√ÉO ##");
      linhas.push("");
      linhas.push(`PACIENTE: ${v("nome")}`);
      linhas.push(`IDADE: ${v("idade")}    SEXO: ${v("sexo")}    RELIGI√ÉO: ${v("religiao")}`);
      if (v("unidade")) linhas.push(`UNIDADE/SETOR: ${v("unidade")}`);
      linhas.push("");
      linhas.push(yesNoBoldLine("ALERGIAS MEDICAMENTOSAS", "alergias"));
      linhas.push(yesNoBoldLine("INTERNA√á√ÉO NOS √öLTIMOS 3 MESES?", "internacao"));
      linhas.push("");
      linhas.push("**H√ÅBITOS DE VIDA:**");
      linhas.push(habitLine("Tabagismo", "tabagismo"));
      linhas.push(habitLine("Etilismo", "etilismo"));
      linhas.push(habitLine("Drogas il√≠citas", "drogas"));
      linhas.push("");
      linhas.push("**HIST√ìRIA PATOL√ìGICA PREGRESSA (HPP):**");
      linhas.push(v("hpp"));
      linhas.push("");
      linhas.push("**HIST√ìRIA FAMILIAR (HF):**");
      linhas.push(v("hf"));
      linhas.push("");
      linhas.push("**MEDICAMENTOS DE USO CONT√çNUO:**");
      linhas.push(v("meds_continuos"));
      linhas.push("");
      linhas.push("**EXAMES LABORATORIAIS:**");
      linhas.push(v("labs"));
      linhas.push("");
      linhas.push("**EXAMES DE IMAGEM:**");
      linhas.push (v("imagem"));
      linhas.push("");
      linhas.push("**QUEIXA PRINCIPAL (QP):**");
      linhas.push(v("qp"));
      linhas.push("");
      linhas.push("**HIST√ìRIA DA DOEN√áA ATUAL (HDA):**");
      linhas.push(v("hda"));
      linhas.push("");
      linhas.push("# EXAME F√çSICO #");
      linhas.push("Sinais Vitais");
      linhas.push(`PA: ${v("pa")} mmHg    FC: ${v("fc")} bpm    FR: ${v("fr")} ipm    SatO2: ${v("sat")}%    T: ${v("temp")}¬∞C    Glicemia: ${v("hgt")} mg/dL`);
      linhas.push("");
      linhas.push("**ECTOSCOPIA:**");
      linhas.push(v("ef_ectoscopia"));
      linhas.push("");
      linhas.push("**Cabe√ßa e pesco√ßo:**");
      linhas.push(v("ef_cp"));
      linhas.push("");
      linhas.push("**ACV:**");
      linhas.push(v("ef_acv"));
      linhas.push("");
      linhas.push("**AP:**");
      linhas.push(v("ef_ap"));
      linhas.push("");
      linhas.push("**ABD:**");
      linhas.push(v("ef_abd"));
      linhas.push("");
      linhas.push("**NEURO:**");
      linhas.push(v("ef_neuro"));
      linhas.push("");
      linhas.push("**MEMBROS:**");
      linhas.push(v("ef_membros"));
      linhas.push("");
      linhas.push("**EXAME NEUROL√ìGICO DETALHADO:**");
      linhas.push(v("neuro_detalhado"));
      linhas.push("");
      const dadosGastro = capturarDadosGastro();
      dadosGastro.forEach(linha => linhas.push(linha));
      
      const dadosPsiq = capturarDadosPsiq();
      dadosPsiq.forEach(linha => linhas.push(linha));
      
      // Adicionar Diagn√≥sticos
      if (v("hd1") || v("hd2") || v("hd3")) {
        linhas.push("");
        linhas.push("# DIAGN√ìSTICOS DIFERENCIAIS / HIP√ìTESES DIAGN√ìSTICAS #");
        linhas.push("");
        if (v("hd1")) {
          const cid1 = v("hd1-cid");
          linhas.push(`**HIP√ìTESE DIAGN√ìSTICA 1 (Principal):** ${v("hd1")}${cid1 ? " (" + cid1 + ")" : ""}`);
        }
        if (v("hd2")) {
          const cid2 = v("hd2-cid");
          linhas.push(`**Hip√≥tese Diagn√≥stica 2:** ${v("hd2")}${cid2 ? " (" + cid2 + ")" : ""}`);
        }
        if (v("hd3")) {
          const cid3 = v("hd3-cid");
          linhas.push(`**Hip√≥tese Diagn√≥stica 3:** ${v("hd3")}${cid3 ? " (" + cid3 + ")" : ""}`);
        }
        linhas.push("");
      }
      
      // Adicionar Conduta e Plano
      if (v("exames-solicitados") || v("prescricao") || v("orientacoes") || v("seguimento")) {
        linhas.push("");
        linhas.push("# CONDUTA E PLANO TERAP√äUTICO #");
        linhas.push("");
        
        if (v("exames-solicitados")) {
          linhas.push("**EXAMES SOLICITADOS:**");
          linhas.push(v("exames-solicitados"));
          linhas.push("");
        }
        
        if (v("prescricao")) {
          linhas.push("**PRESCRI√á√ÉO / TRATAMENTO:**");
          linhas.push(v("prescricao"));
          linhas.push("");
        }
        
        if (v("orientacoes")) {
          linhas.push("**ORIENTA√á√ïES AO PACIENTE:**");
          linhas.push(v("orientacoes"));
          linhas.push("");
        }
        
        if (v("seguimento")) {
          linhas.push("**PLANO DE SEGUIMENTO:**");
          linhas.push(v("seguimento"));
          linhas.push("");
        }
      }
      
      // Adicionar scores calculados (se houver)
      const scoresTexto = obterScoresTexto();
      if (scoresTexto) {
        linhas.push(scoresTexto);
      }
      
      return linhas.join("\n");
    }

    // ============ FORMATA√á√ÉO HDA ============
    function formatarHDA(tipo) {
      const textarea = document.getElementById('hda');
      const start = textarea.selectionStart;
      const end = textarea.selectionEnd;
      const selectedText = textarea.value.substring(start, end);
      
      if (!selectedText) {
        alert('‚ö†Ô∏è Selecione o texto que deseja formatar primeiro!');
        return;
      }
      
      let formattedText = '';
      if (tipo === 'bold') {
        formattedText = `**${selectedText}**`;
      } else if (tipo === 'italic') {
        formattedText = `*${selectedText}*`;
      }
      
      textarea.value = textarea.value.substring(0, start) + formattedText + textarea.value.substring(end);
      
      // Manter foco e ajustar sele√ß√£o
      textarea.focus();
      textarea.selectionStart = start;
      textarea.selectionEnd = start + formattedText.length;
    }
    
    function aplicarTamanhoFonteHDA() {
      const textarea = document.getElementById('hda');
      const select = document.getElementById('hdaFontSize');
      const tamanho = select.value;
      
      if (!tamanho) {
        alert('‚ö†Ô∏è Selecione um tamanho de fonte primeiro!');
        return;
      }
      
      const start = textarea.selectionStart;
      const end = textarea.selectionEnd;
      const selectedText = textarea.value.substring(start, end);
      
      if (!selectedText) {
        alert('‚ö†Ô∏è Selecione o texto que deseja modificar primeiro!');
        return;
      }
      
      let formattedText = '';
      if (tamanho === 'small') {
        formattedText = `[PEQUENO]${selectedText}[/PEQUENO]`;
      } else if (tamanho === 'normal') {
        formattedText = `[NORMAL]${selectedText}[/NORMAL]`;
      } else if (tamanho === 'large') {
        formattedText = `[GRANDE]${selectedText}[/GRANDE]`;
      }
      
      textarea.value = textarea.value.substring(0, start) + formattedText + textarea.value.substring(end);
      
      // Resetar sele√ß√£o
      select.value = '';
      
      // Manter foco
      textarea.focus();
      textarea.selectionStart = start;
      textarea.selectionEnd = start + formattedText.length;
    }

    // ============ CID-10 - BANCO SIMPLIFICADO ============
    const CID10_DATABASE = [
      // Doen√ßas mais comuns
      {codigo: "I10", descricao: "Hipertens√£o essencial (prim√°ria)"},
      {codigo: "E11", descricao: "Diabetes mellitus tipo 2"},
      {codigo: "E78", descricao: "Dist√∫rbios do metabolismo de lipoprote√≠nas"},
      {codigo: "J06.9", descricao: "Infec√ß√£o aguda das vias a√©reas superiores"},
      {codigo: "J18.9", descricao: "Pneumonia n√£o especificada"},
      {codigo: "J20.9", descricao: "Bronquite aguda n√£o especificada"},
      {codigo: "J45", descricao: "Asma"},
      {codigo: "K21", descricao: "Doen√ßa do refluxo gastroesof√°gico"},
      {codigo: "K29", descricao: "Gastrite e duodenite"},
      {codigo: "K30", descricao: "Dispepsia"},
      {codigo: "K59.0", descricao: "Constipa√ß√£o"},
      {codigo: "K59.1", descricao: "Diarreia funcional"},
      {codigo: "R10.4", descricao: "Dores abdominais e p√©lvicas"},
      {codigo: "R51", descricao: "Cefaleia"},
      {codigo: "R50", descricao: "Febre de origem desconhecida"},
      {codigo: "M54.5", descricao: "Dor lombar baixa"},
      {codigo: "M79.1", descricao: "Mialgia"},
      {codigo: "A09", descricao: "Diarreia e gastroenterite"},
      {codigo: "N39.0", descricao: "Infec√ß√£o do trato urin√°rio"},
      {codigo: "L50", descricao: "Urtic√°ria"},
      
      // Psiquiatria
      {codigo: "F32", descricao: "Epis√≥dios depressivos"},
      {codigo: "F33", descricao: "Transtorno depressivo recorrente"},
      {codigo: "F41.1", descricao: "Transtorno de ansiedade generalizada"},
      {codigo: "F41.0", descricao: "Transtorno de p√¢nico"},
      {codigo: "F40", descricao: "Transtornos f√≥bico-ansiosos"},
      {codigo: "F42", descricao: "Transtorno obsessivo-compulsivo"},
      {codigo: "F43.1", descricao: "Transtorno de estresse p√≥s-traum√°tico"},
      {codigo: "F31", descricao: "Transtorno afetivo bipolar"},
      {codigo: "F20", descricao: "Esquizofrenia"},
      {codigo: "F10", descricao: "Transtornos mentais e comportamentais devido ao uso de √°lcool"},
      {codigo: "F17", descricao: "Transtornos mentais e comportamentais devido ao uso de fumo"},
      {codigo: "F50", descricao: "Transtornos alimentares"},
      {codigo: "F51", descricao: "Transtornos do sono n√£o-org√¢nicos"},
      
      // Cardiologia
      {codigo: "I20", descricao: "Angina pectoris"},
      {codigo: "I21", descricao: "Infarto agudo do mioc√°rdio"},
      {codigo: "I48", descricao: "Fibrila√ß√£o e flutter atrial"},
      {codigo: "I50", descricao: "Insufici√™ncia card√≠aca"},
      {codigo: "I63", descricao: "Infarto cerebral"},
      {codigo: "I64", descricao: "Acidente vascular cerebral"},
      
      // Outros
      {codigo: "B34.9", descricao: "Infec√ß√£o viral n√£o especificada"},
      {codigo: "G43", descricao: "Enxaqueca"},
      {codigo: "G44", descricao: "Outras s√≠ndromes de cefaleia"},
      {codigo: "Z00", descricao: "Exame m√©dico geral"},
      {codigo: "Z71", descricao: "Orienta√ß√£o e aconselhamento"},
    ];

    function buscarCID10() {
      const termo = document.getElementById('busca-cid').value.trim().toLowerCase();
      if (!termo) {
        alert('‚ö†Ô∏è Digite um termo para buscar!');
        return;
      }
      
      const resultados = CID10_DATABASE.filter(item => 
        item.codigo.toLowerCase().includes(termo) ||
        item.descricao.toLowerCase().includes(termo)
      );
      
      const divResultados = document.getElementById('resultados-cid');
      
      if (resultados.length === 0) {
        divResultados.innerHTML = '<p style="color:#999; font-size:0.9rem;">Nenhum resultado encontrado. Tente outro termo.</p>';
        divResultados.style.display = 'block';
        return;
      }
      
      let html = '<p style="font-weight:700; margin-bottom:8px; font-size:0.9rem;">Clique para selecionar:</p>';
      resultados.forEach(item => {
        html += `
          <div onclick="selecionarCID('${item.codigo}', '${item.descricao.replace(/'/g, "\\'")}');" 
               style="padding:8px; margin:4px 0; background:white; border-left:3px solid var(--primary); border-radius:4px; cursor:pointer; transition:0.2s;"
               onmouseover="this.style.background='#e0f7fa'" 
               onmouseout="this.style.background='white'">
            <strong style="color:var(--primary);">${item.codigo}</strong> - ${item.descricao}
          </div>
        `;
      });
      
      divResultados.innerHTML = html;
      divResultados.style.display = 'block';
    }

    function selecionarCID(codigo, descricao) {
      // Preencher primeiro HD vazio
      if (!v('hd1')) {
        document.getElementById('hd1').value = descricao;
        document.getElementById('hd1-cid').value = codigo;
      } else if (!v('hd2')) {
        document.getElementById('hd2').value = descricao;
        document.getElementById('hd2-cid').value = codigo;
      } else if (!v('hd3')) {
        document.getElementById('hd3').value = descricao;
        document.getElementById('hd3-cid').value = codigo;
      } else {
        alert('‚ö†Ô∏è Todas as hip√≥teses diagn√≥sticas j√° est√£o preenchidas!');
        return;
      }
      
      // Limpar busca
      document.getElementById('busca-cid').value = '';
      document.getElementById('resultados-cid').style.display = 'none';
      
      alert(`‚úÖ CID-10 adicionado: ${codigo} - ${descricao}`);
    }

    // ============ LEMBRETES E ALERTAS ============
    const LEMBRETES_KEY = 'anamnese_lembretes';

    function salvarLembrete() {
      const nomePaciente = v('nome');
      const dataRetorno = document.getElementById('data-retorno').value;
      const obsRetorno = v('obs-retorno');
      
      if (!nomePaciente) {
        alert('‚ö†Ô∏è Preencha o nome do paciente primeiro!');
        return;
      }
      
      if (!dataRetorno) {
        alert('‚ö†Ô∏è Selecione uma data de retorno!');
        return;
      }
      
      const lembretes = obterLembretes();
      
      const lembrete = {
        id: Date.now() + '_' + Math.random().toString(36).substr(2, 9),
        paciente: nomePaciente,
        data: dataRetorno,
        observacao: obsRetorno,
        criado: new Date().toISOString()
      };
      
      lembretes.push(lembrete);
      localStorage.setItem(LEMBRETES_KEY, JSON.stringify(lembretes));
      
      alert(`‚úÖ Lembrete de retorno salvo para ${nomePaciente} em ${formatarDataBR(dataRetorno)}!`);
      
      // Limpar campos
      document.getElementById('data-retorno').value = '';
      document.getElementById('obs-retorno').value = '';
      
      // Atualizar badge
      atualizarBadgeLembretes();
    }

    function obterLembretes() {
      try {
        const data = localStorage.getItem(LEMBRETES_KEY);
        return data ? JSON.parse(data) : [];
      } catch (e) {
        return [];
      }
    }

    function formatarDataBR(dataISO) {
      if (!dataISO) return '';
      const partes = dataISO.split('-');
      return `${partes[2]}/${partes[1]}/${partes[0]}`;
    }

    function verificarLembretesHoje() {
      const lembretes = obterLembretes();
      const hoje = new Date().toISOString().split('T')[0];
      
      const lembretesHoje = lembretes.filter(l => l.data === hoje);
      
      if (lembretesHoje.length > 0) {
        let msg = 'üîî LEMBRETES DE HOJE:\n\n';
        lembretesHoje.forEach(l => {
          msg += `üìã ${l.paciente}\n`;
          if (l.observacao) msg += `   ${l.observacao}\n`;
          msg += '\n';
        });
        
        setTimeout(() => {
          if (confirm(msg + 'Deseja ver todos os lembretes?')) {
            abrirModalLembretes();
          }
        }, 2000);
      }
    }

    function abrirModalLembretes() {
      const lembretes = obterLembretes();
      const hoje = new Date().toISOString().split('T')[0];
      
      let html = `
        <div style="position:fixed; inset:0; background:rgba(0,0,0,0.6); z-index:10000; display:flex; align-items:center; justify-content:center;" id="modal-lembretes-overlay" onclick="fecharModalLembretes()">
          <div onclick="event.stopPropagation()" style="background:white; width:92%; max-width:700px; max-height:85vh; border-radius:12px; padding:20px; overflow-y:auto; box-shadow:0 10px 30px rgba(0,0,0,0.3);">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:16px; padding-bottom:12px; border-bottom:2px solid var(--light);">
              <h2 style="margin:0; color:var(--primary);">üîî Lembretes de Retorno</h2>
              <button onclick="fecharModalLembretes()" style="background:var(--alert); color:white; border:none; padding:8px 16px; border-radius:6px; cursor:pointer; font-weight:800;">Fechar</button>
            </div>
      `;
      
      if (lembretes.length === 0) {
        html += '<p style="text-align:center; color:#999; padding:40px;">Nenhum lembrete cadastrado</p>';
      } else {
        // Ordenar por data
        lembretes.sort((a, b) => new Date(a.data) - new Date(b.data));
        
        lembretes.forEach(l => {
          const isPast = l.data < hoje;
          const isToday = l.data === hoje;
          const cor = isToday ? '#4caf50' : isPast ? '#f44336' : '#2196f3';
          const status = isToday ? 'üîî HOJE' : isPast ? '‚ö†Ô∏è ATRASADO' : 'üìÖ FUTURO';
          
          html += `
            <div style="background:#f9f9f9; border-left:4px solid ${cor}; padding:12px; margin-bottom:10px; border-radius:6px;">
              <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
                <strong style="color:var(--primary); font-size:1.05rem;">${l.paciente}</strong>
                <span style="background:${cor}; color:white; padding:4px 10px; border-radius:12px; font-size:0.75rem; font-weight:700;">${status}</span>
              </div>
              <p style="margin:4px 0; font-size:0.9rem;"><strong>Data:</strong> ${formatarDataBR(l.data)}</p>
              ${l.observacao ? `<p style="margin:4px 0; font-size:0.85rem; color:#666;">${l.observacao}</p>` : ''}
              <button onclick="excluirLembrete('${l.id}')" style="margin-top:8px; background:var(--alert); color:white; border:none; padding:6px 12px; border-radius:4px; cursor:pointer; font-size:0.8rem; font-weight:700;">üóëÔ∏è Excluir</button>
            </div>
          `;
        });
      }
      
      html += '</div></div>';
      
      const div = document.createElement('div');
      div.id = 'modal-lembretes';
      div.innerHTML = html;
      document.body.appendChild(div);
    }

    function fecharModalLembretes() {
      const modal = document.getElementById('modal-lembretes');
      if (modal) modal.remove();
    }

    function excluirLembrete(id) {
      if (!confirm('Deseja excluir este lembrete?')) return;
      
      let lembretes = obterLembretes();
      lembretes = lembretes.filter(l => l.id !== id);
      localStorage.setItem(LEMBRETES_KEY, JSON.stringify(lembretes));
      
      fecharModalLembretes();
      abrirModalLembretes();
      atualizarBadgeLembretes();
    }

    // Verificar lembretes ao carregar
    window.addEventListener('load', function() {
      setTimeout(verificarLembretesHoje, 1000);
      atualizarBadgeLembretes();
    });

    function atualizarBadgeLembretes() {
      const lembretes = obterLembretes();
      const hoje = new Date().toISOString().split('T')[0];
      
      // Contar lembretes de hoje + atrasados
      const pendentes = lembretes.filter(l => l.data <= hoje).length;
      
      const badge = document.getElementById('badge-lembretes');
      if (badge) {
        if (pendentes > 0) {
          badge.textContent = pendentes;
          badge.style.display = 'flex';
        } else {
          badge.style.display = 'none';
        }
      }
    }

    function gerarRelatorio(){
      const texto = montarTextoRelatorioBase();
      document.getElementById("finalReport").value = texto;
      document.getElementById("modalResultado").style.display = "flex";
    }

    function fecharModal(){
      document.getElementById("modalResultado").style.display = "none";
    }

    function copiar(){
      const ta = document.getElementById("finalReport");
      ta.select();
      document.execCommand("copy");
      alert("Texto copiado!");
    }

  function salvarPDF(){
  const texto = document.getElementById("finalReport").value;
  const linhas = texto.split("\n");

  const now = new Date();
  const dataHora = now.toLocaleString("pt-BR", {
    day: "2-digit",
    month: "2-digit",
    year: "numeric",
    hour: "2-digit",
    minute: "2-digit"
  });

  const printWindow = window.open("", "_blank");

  function renderLinha(l){
    if (!l.trim()) return `<div class="space"></div>`;

    if (l.startsWith("##") && l.endsWith("##")){
      return `<h1>${l.replace(/#/g,"").trim()}</h1>`;
    }

    if (l.startsWith("# ") && l.endsWith(" #")){
      return `<h2>${l.replace(/#/g,"").trim()}</h2>`;
    }

    if (l.startsWith("**") && l.endsWith("**")){
      return `<h3>${l.replace(/\*/g,"").trim()}</h3>`;
    }

    if (l.startsWith("PA:")){
      return `<div class="vitals">${l}</div>`;
    }

    return `<p>${l}</p>`;
  }

  printWindow.document.write(`
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Anamnese - ${v("nome")}</title>
<style>
.signature{
  margin-top: 40px;
  text-align: left;
}

.signature .line{
  width: 320px;
  border-top: 1.5px solid #000;
  margin-bottom: 6px;
}

.signature .label{
  font-size: 10.5pt;
  color: #333;
}

@page { margin: 1.5cm; }

body{
  font-family: Arial, Helvetica, sans-serif;
  font-size: 11.5pt;
  line-height: 1.5;
  color: #111;
}

.header{
  text-align: center;
  border-bottom: 2px solid #00695c;
  margin-bottom: 20px;
  padding-bottom: 10px;
}

.header h1{
  margin: 0;
  color: #00695c;
  font-size: 18pt;
}

.header .info{
  font-size: 10pt;
  margin-top: 4px;
}

h1{
  font-size: 16pt;
  margin: 20px 0 10px;
  color: #00695c;
}

h2{
  font-size: 14pt;
  margin: 18px 0 8px;
  border-left: 5px solid #00695c;
  padding-left: 8px;
}

h3{
  font-size: 12pt;
  margin: 14px 0 4px;
}

p{
  margin: 0 0 6px 0;
  text-align: justify;
}

.vitals{
  background: #f2f2f2;
  padding: 8px;
  margin: 10px 0;
  font-weight: bold;
  border-radius: 6px;
}

.space{
  height: 8px;
}

@media print{
  h1,h2,h3{ page-break-after: avoid; }
  p, .vitals{ page-break-inside: avoid; }
}
</style>
</head>

<body>
<div class="header">
  <h1>ANAMNESE FAST</h1>
  <div class="info">
    PACIENTE: ${v("nome")} | IDADE: ${v("idade")} | SEXO: ${v("sexo")}
  </div>
  ${v("unidade") ? `<div class="info">UNIDADE: ${v("unidade")}</div>` : ""}
  <div class="info">DATA/HORA: ${dataHora}</div>
</div>

${linhas.map(renderLinha).join("")}
<div class="signature">
  <div class="line"></div>
  <div class="label">Respons√°vel pelo preenchimento</div>
</div>

</body>
</html>
  `);

  printWindow.document.close();
  setTimeout(() => printWindow.print(), 400);
}

    function limparTudo(){
      if (!confirm("Deseja limpar todos os campos e iniciar uma nova anamnese?")) return;
      const sexoAtual = document.getElementById("sexo").value;
      document.getElementById("nome").value = "";
      document.getElementById("idade").value = "";
      document.getElementById("unidade").value = "";
      document.getElementById("religiao").value = "Cat√≥lico";
      setOption("alergias", "N√£o");
      setOption("internacao", "N√£o");
      setOption("tabagismo", "N√£o");
      setOption("etilismo", "N√£o");
      setOption("drogas", "N√£o");
      document.getElementById("hpp").value = "";
      document.getElementById("hf").value = "";
      document.getElementById("meds_continuos").value = "";
      document.getElementById("labs").value = "";
      document.getElementById("qp").value = "";
      document.getElementById("hda").value = "";
      document.getElementById("pa").value = "";
      document.getElementById("fc").value = "";
      document.getElementById("fr").value = "";
      document.getElementById("sat").value = "";
      document.getElementById("temp").value = "";
      document.getElementById("hgt").value = "";
      document.getElementById("tab_cigs_dia").value = "";
      document.getElementById("tab_anos").value = "";
      document.getElementById("tab_carga").innerText = "0";
      ["ef_ectoscopia","ef_cp","ef_acv","ef_ap","ef_abd","ef_neuro","ef_membros","neuro_detalhado"].forEach(id => {
        const el = document.getElementById(id);
        if (el) el.value = "";
      });
      
      // Limpar scores calculados
      limparScores();
      
      aplicarGenero(sexoAtual);
      initMedsField();
      ensureMedsPrefix();
      window.scrollTo({top: 0, behavior: "smooth"});
    }

    window.addEventListener("load", () => {
      const sexoAtual = document.getElementById("sexo").value;
      aplicarGenero(sexoAtual);
      initLastAuto(sexoAtual);
      initMedsField();
    });

(function() {
  const CRED_KEY = 'anamnese_credentials';
  const SESSION_KEY = 'anamnese_auth_session';

  async function hashSenha(senha) {
    const encoder = new TextEncoder();
    const data = encoder.encode(senha);
    const hashBuffer = await crypto.subtle.digest('SHA-256', data);
    const hashArray = Array.from(new Uint8Array(hashBuffer));
    return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
  }

  function salvarCredenciais(usuario, senhaHash) {
    try {
      localStorage.setItem(CRED_KEY, JSON.stringify({ usuario, senhaHash }));
    } catch (e) {
      console.error('Erro ao salvar credenciais:', e);
    }
  }

  function obterCredenciais() {
    try {
      const data = localStorage.getItem(CRED_KEY);
      return data ? JSON.parse(data) : null;
    } catch (e) {
      return null;
    }
  }

  function limparCredenciais() {
    try {
      localStorage.removeItem(CRED_KEY);
      sessionStorage.removeItem(SESSION_KEY);
    } catch (e) {
      console.error('Erro ao limpar credenciais:', e);
    }
  }

  function criarSessao() {
    try {
      sessionStorage.setItem(SESSION_KEY, '1');
    } catch (e) {
      console.error('Erro ao criar sess√£o:', e);
    }
  }

  function verificarSessao() {
    try {
      return sessionStorage.getItem(SESSION_KEY) === '1';
    } catch (e) {
      return false;
    }
  }

  function esconderLogin() {
    const overlay = document.getElementById('loginOverlay');
    if (overlay) overlay.style.display = 'none';
  }

  function mostrarLogin() {
    const overlay = document.getElementById('loginOverlay');
    if (overlay) overlay.style.display = 'flex';
  }

  function mostrarTela(tela) {
    ['telaLogin', 'telaCadastro', 'telaReset'].forEach(id => {
      const el = document.getElementById(id);
      if (el) el.style.display = id === tela ? 'block' : 'none';
    });
  }

  window.mostrarReset = function() {
    mostrarTela('telaReset');
  };

  window.voltarLogin = function() {
    mostrarTela('telaLogin');
    limparErros();
  };

  function limparErros() {
    const erros = ['loginErro', 'cadastroErro'];
    erros.forEach(id => {
      const el = document.getElementById(id);
      if (el) el.style.display = 'none';
    });
  }

  function mostrarErro(id, mensagem) {
    const el = document.getElementById(id);
    if (el) {
      el.textContent = mensagem;
      el.style.display = 'block';
    }
  }

  async function fazerLogin() {
    limparErros();
    
    const usuario = document.getElementById('loginUsuario')?.value?.trim();
    const senha = document.getElementById('loginSenha')?.value;

    if (!usuario || !senha) {
      mostrarErro('loginErro', 'Preencha usu√°rio e senha.');
      return;
    }

    const credenciais = obterCredenciais();
    if (!credenciais) {
      mostrarErro('loginErro', 'Nenhuma conta cadastrada.');
      return;
    }

    const senhaHash = await hashSenha(senha);

    if (usuario === credenciais.usuario && senhaHash === credenciais.senhaHash) {
      criarSessao();
      esconderLogin();
      inicializarApp();
    } else {
      mostrarErro('loginErro', 'Usu√°rio ou senha incorretos.');
    }
  }

  async function fazerCadastro() {
    limparErros();

    const usuario = document.getElementById('cadastroUsuario')?.value?.trim();
    const senha = document.getElementById('cadastroSenha')?.value;
    const senhaConfirm = document.getElementById('cadastroSenhaConfirm')?.value;

    if (!usuario || !senha || !senhaConfirm) {
      mostrarErro('cadastroErro', 'Preencha todos os campos.');
      return;
    }

    if (usuario.length < 3) {
      mostrarErro('cadastroErro', 'Usu√°rio deve ter pelo menos 3 caracteres.');
      return;
    }

    if (senha.length < 4) {
      mostrarErro('cadastroErro', 'Senha deve ter pelo menos 4 caracteres.');
      return;
    }

    if (senha !== senhaConfirm) {
      mostrarErro('cadastroErro', 'As senhas n√£o coincidem.');
      return;
    }

    const senhaHash = await hashSenha(senha);
    salvarCredenciais(usuario, senhaHash);
    criarSessao();
    esconderLogin();
    inicializarApp();
    alert(`‚úÖ Conta criada com sucesso! Bem-vindo, ${usuario}!`);
  }

  function resetarCredenciais() {
    if (confirm('‚ö†Ô∏è Tem certeza? Isso apagar√° seu usu√°rio e senha atuais.')) {
      limparCredenciais();
      alert('‚úÖ Credenciais resetadas. Voc√™ pode criar uma nova conta.');
      location.reload();
    }
  }

  function inicializarApp() {
    try {
      const sexoAtual = document.getElementById('sexo')?.value || 'M';
      if (typeof window.initLastAuto === 'function') window.initLastAuto(sexoAtual);
      if (typeof window.aplicarGenero === 'function') window.aplicarGenero(sexoAtual);
      if (typeof window.initMedsField === 'function') window.initMedsField();
    } catch (e) {
      console.warn('Erro ao inicializar app:', e);
    }
  }

  function inicializarLogin() {
    const credenciais = obterCredenciais();

    if (!credenciais) {
      mostrarTela('telaCadastro');
      mostrarLogin();
      setTimeout(() => {
        const cadastroUsuario = document.getElementById('cadastroUsuario');
        if (cadastroUsuario) cadastroUsuario.focus();
      }, 100);
    } else if (verificarSessao()) {
      esconderLogin();
      inicializarApp();
    } else {
      mostrarTela('telaLogin');
      mostrarLogin();
      setTimeout(() => {
        const loginUsuario = document.getElementById('loginUsuario');
        if (loginUsuario) loginUsuario.focus();
      }, 100);
    }

    const btnLogin = document.getElementById('loginEntrar');
    if (btnLogin) btnLogin.addEventListener('click', fazerLogin);

    const btnCadastro = document.getElementById('cadastroBotao');
    if (btnCadastro) btnCadastro.addEventListener('click', fazerCadastro);

    const btnReset = document.getElementById('resetConfirmar');
    if (btnReset) btnReset.addEventListener('click', resetarCredenciais);

    const loginSenha = document.getElementById('loginSenha');
    if (loginSenha) {
      loginSenha.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') fazerLogin();
      });
    }

    const cadastroSenhaConfirm = document.getElementById('cadastroSenhaConfirm');
    if (cadastroSenhaConfirm) {
      cadastroSenhaConfirm.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') fazerCadastro();
      });
    }
  }

  document.addEventListener('DOMContentLoaded', inicializarLogin);
})();

(function () {
  const HISTORICO_KEY = 'anamnese_historico';

  function gerarId() {
    return Date.now() + '_' + Math.random().toString(36).substr(2, 9);
  }

  function obterPacientes() {
    try {
      const data = localStorage.getItem(HISTORICO_KEY);
      return data ? JSON.parse(data) : [];
    } catch (e) {
      console.warn('Erro ao carregar hist√≥rico:', e);
      return [];
    }
  }

  function salvarPacientes(pacientes) {
    try {
      localStorage.setItem(HISTORICO_KEY, JSON.stringify(pacientes));
    } catch (e) {
      console.warn('Erro ao salvar hist√≥rico:', e);
    }
  }

  function coletarDadosPaciente() {
    const fieldIds = [
      'responsavel', 'nome', 'idade', 'sexo', 'religiao', 'unidade',
      'alergias-detalhe', 'internacao-detalhe',
      'tabagismo-detalhe', 'tab_cigs_dia', 'tab_anos',
      'etilismo-detalhe', 'drogas-detalhe',
      'qp', 'hda', 'hpp', 'meds_continuos', 'hf', 'labs', 'imagem',
      'pa', 'fc', 'fr', 'sat', 'temp', 'hgt',
      'ef_ectoscopia', 'ef_cp', 'ef_acv', 'ef_ap', 'ef_abd', 'ef_neuro', 'ef_membros',
      'neuro_detalhado'
    ];

    const data = { fields: {}, toggles: {} };

    fieldIds.forEach(id => {
      const el = document.getElementById(id);
      if (el) {
        data.fields[id] = el.value || '';
      }
    });

    const toggleStates = ['alergias', 'internacao', 'tabagismo', 'etilismo', 'drogas'];
    toggleStates.forEach(key => {
      if (typeof state !== 'undefined' && state[key]) {
        data.toggles[key] = state[key];
      } else {
        data.toggles[key] = 'N√£o';
      }
    });

    return data;
  }

  window.salvarPacienteAtual = function () {
    const nome = document.getElementById('nome')?.value?.trim();
    
    if (!nome) {
      alert('‚ö†Ô∏è Digite o nome do paciente antes de salvar!');
      return;
    }

    const dados = coletarDadosPaciente();
    let pacientes = obterPacientes();
    
    // Verificar se j√° existe paciente com o mesmo nome
    const indiceExistente = pacientes.findIndex(p => 
      p.nome.toLowerCase() === nome.toLowerCase()
    );

    if (indiceExistente !== -1) {
      // Paciente j√° existe - perguntar se quer atualizar
      if (confirm(`‚ö†Ô∏è J√° existe uma anamnese salva para "${nome}".\n\nDeseja ATUALIZAR a anamnese existente?`)) {
        // Atualizar paciente existente
        pacientes[indiceExistente] = {
          ...pacientes[indiceExistente],
          idade: dados.fields.idade || '',
          sexo: dados.fields.sexo || 'M',
          unidade: dados.fields.unidade || '',
          queixa: dados.fields.qp || '',
          dataAtualizacao: new Date().toISOString(),
          dados: dados
        };
        
        salvarPacientes(pacientes);
        alert(`‚úÖ Anamnese de "${nome}" ATUALIZADA com sucesso!`);
        atualizarListaPacientes();
        return;
      } else {
        return; // Cancelou a atualiza√ß√£o
      }
    }

    // Novo paciente - criar novo registro
    const paciente = {
      id: gerarId(),
      nome: nome,
      idade: dados.fields.idade || '',
      sexo: dados.fields.sexo || 'M',
      unidade: dados.fields.unidade || '',
      queixa: dados.fields.qp || '',
      dataSalvo: new Date().toISOString(),
      dados: dados
    };

    pacientes.unshift(paciente);
    salvarPacientes(pacientes);

    alert(`‚úÖ Paciente "${nome}" salvo com sucesso!`);
    atualizarListaPacientes();
  };
  
  // Fun√ß√£o para salvar do modal (ap√≥s gerar relat√≥rio)
  window.salvarAnamneseAtual = function() {
    window.salvarPacienteAtual();
  };

  function carregarPaciente(dados) {
    if (!confirm('‚ö†Ô∏è Isso substituir√° os dados atuais. Deseja continuar?')) {
      return;
    }

    if (dados.fields) {
      Object.keys(dados.fields).forEach(id => {
        const el = document.getElementById(id);
        if (el) {
          el.value = dados.fields[id] || '';
        }
      });
    }

    if (dados.toggles) {
      Object.keys(dados.toggles).forEach(key => {
        const value = dados.toggles[key];
        if (typeof window.setOption === 'function') {
          try {
            window.setOption(key, value);
          } catch (e) {
            console.warn('Erro ao restaurar toggle:', key, e);
          }
        }
      });
    }

    if (typeof window.calcularCargaTabagica === 'function') {
      try {
        window.calcularCargaTabagica();
      } catch (e) {
        console.warn('Erro ao calcular carga tab√°gica:', e);
      }
    }

    const sexo = document.getElementById('sexo')?.value;
    if (sexo && typeof window.aplicarGenero === 'function') {
      try {
        window.aplicarGenero(sexo);
      } catch (e) {
        console.warn('Erro ao aplicar g√™nero:', e);
      }
    }

    fecharHistorico();
    alert('‚úÖ Dados do paciente carregados!');
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  function excluirPaciente(id) {
    if (!confirm('‚ö†Ô∏è Tem certeza que deseja excluir este paciente do hist√≥rico?')) {
      return;
    }

    let pacientes = obterPacientes();
    pacientes = pacientes.filter(p => p.id !== id);
    salvarPacientes(pacientes);
    atualizarListaPacientes();
    alert('‚úÖ Paciente exclu√≠do do hist√≥rico');
  }

  function formatarData(isoString) {
    try {
      const data = new Date(isoString);
      return data.toLocaleString('pt-BR', {
        day: '2-digit',
        month: '2-digit',
        year: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      });
    } catch (e) {
      return 'Data inv√°lida';
    }
  }

  function atualizarListaPacientes(filtro = '') {
    const lista = document.getElementById('listaPacientes');
    const count = document.getElementById('pacientesCount');
    
    if (!lista) return;

    const pacientes = obterPacientes();
    const filtroLower = filtro.toLowerCase();
    const pacientesFiltrados = filtro 
      ? pacientes.filter(p => p.nome.toLowerCase().includes(filtroLower))
      : pacientes;

    if (count) {
      count.textContent = `${pacientesFiltrados.length} paciente${pacientesFiltrados.length !== 1 ? 's' : ''} ${filtro ? 'encontrado' : 'salvo'}${pacientesFiltrados.length !== 1 ? 's' : ''}`;
    }

    if (pacientesFiltrados.length === 0) {
      lista.innerHTML = `
        <div class="empty-state">
          <p>üì≠</p>
          <p>${filtro ? 'Nenhum paciente encontrado' : 'Nenhum paciente salvo ainda'}</p>
        </div>
      `;
      return;
    }

    lista.innerHTML = pacientesFiltrados.map(p => `
      <div class="paciente-item">
        <div class="paciente-item-header">
          <div class="paciente-nome">${p.nome || 'Sem nome'}</div>
          <div class="paciente-data">${p.dataAtualizacao ? '‚úèÔ∏è ' + formatarData(p.dataAtualizacao) : formatarData(p.dataSalvo)}</div>
        </div>
        <div class="paciente-info">
          ${p.idade ? `${p.idade} anos` : ''} ${p.idade && p.sexo ? '‚Ä¢' : ''} ${p.sexo === 'M' ? 'Masculino' : 'Feminino'}
          ${p.unidade ? ` ‚Ä¢ ${p.unidade}` : ''}
        </div>
        ${p.queixa ? `<div class="paciente-info" style="font-style: italic; color: #777;">QP: ${p.queixa.substring(0, 60)}${p.queixa.length > 60 ? '...' : ''}</div>` : ''}
        <div class="paciente-actions">
          <button class="btn-carregar" onclick="window.carregarPacienteById('${p.id}')">üìÇ Carregar</button>
          <button class="btn-excluir" onclick="window.excluirPacienteById('${p.id}')">üóëÔ∏è Excluir</button>
        </div>
      </div>
    `).join('');
  }

  window.carregarPacienteById = function (id) {
    const pacientes = obterPacientes();
    const paciente = pacientes.find(p => p.id === id);
    if (paciente) {
      carregarPaciente(paciente.dados);
    }
  };

  window.excluirPacienteById = function (id) {
    excluirPaciente(id);
  };

  window.abrirHistorico = function () {
    const modal = document.getElementById('modalHistorico');
    if (modal) {
      modal.classList.add('show');
      atualizarListaPacientes();
      
      setTimeout(() => {
        const search = document.getElementById('searchPaciente');
        if (search) search.focus();
      }, 100);
    }
  };

  window.fecharHistorico = function () {
    const modal = document.getElementById('modalHistorico');
    if (modal) {
      modal.classList.remove('show');
      const search = document.getElementById('searchPaciente');
      if (search) search.value = '';
    }
  };

  window.addEventListener('load', function () {
    const btnHistorico = document.getElementById('btnHistorico');
    if (btnHistorico) {
      btnHistorico.addEventListener('click', abrirHistorico);
    }

    const searchInput = document.getElementById('searchPaciente');
    if (searchInput) {
      searchInput.addEventListener('input', function (e) {
        atualizarListaPacientes(e.target.value);
      });
    }

    // Interceptar gera√ß√£o de relat√≥rio para perguntar sobre salvamento
    const originalGerarRelatorio = window.gerarRelatorio;
    if (typeof originalGerarRelatorio === 'function') {
      window.gerarRelatorio = function () {
        originalGerarRelatorio();
        
        // Perguntar para salvar ap√≥s mostrar o relat√≥rio
        setTimeout(() => {
          const nome = document.getElementById('nome')?.value?.trim();
          if (nome && confirm('üíæ Deseja salvar esta anamnese no hist√≥rico?')) {
            window.salvarPacienteAtual();
          }
        }, 500);
      };
    }
  });
})();

  // Abrir/fechar modal
  function abrirScores() {
    document.getElementById("modal-scores").style.display = "block";
    document.getElementById("modal-scores-backdrop").style.display = "block";
  }

  function fecharScores() {
    document.getElementById("modal-scores").style.display = "none";
    document.getElementById("modal-scores-backdrop").style.display = "none";
  }

  // ---------- CURB-65 ----------
  function calcCURB65({confusao, ureiaAlta, respi30, pasBaixa, idade65}) {
    let score = 0;
    if (confusao) score++;
    if (ureiaAlta) score++;
    if (respi30) score++;
    if (pasBaixa) score++;
    if (idade65) score++;

    let risco;
    if (score <= 1) {
      risco = "baixo risco (~1‚Äì2% mortalidade, geralmente ambulatorial)";
    } else if (score === 2) {
      risco = "risco intermedi√°rio (~9% mortalidade, considerar interna√ß√£o)";
    } else if (score === 3) {
      risco = "alto risco (~22% mortalidade, interna√ß√£o e avaliar UTI)";
    } else {
      risco = "muito alto risco (>30% mortalidade, forte indica√ß√£o de UTI)";
    }

    return { score, risco };
  }

  function atualizaCURB65() {
    const dados = {
      confusao: document.getElementById("curb-confusao").checked,
      ureiaAlta: document.getElementById("curb-ureia").checked,
      respi30: document.getElementById("curb-fr30").checked,
      pasBaixa: document.getElementById("curb-pa").checked,
      idade65: document.getElementById("curb-idade65").checked
    };

    const { score, risco } = calcCURB65(dados);
    const texto = `CURB-65: ${score} ponto(s) ‚Äì ${risco}`;
    document.getElementById("curb-resultado").textContent = texto;
    
    // Salvar score calculado
    salvarScore("CURB-65", `${score}/5`, risco);
  }

  // ---------- Glasgow ----------
  function calcGCS({ocular, verbal, motora}) {
    const e = Number(ocular);
    const v = Number(verbal);
    const m = Number(motora);
    const total = e + v + m;

    let classificacao;
    if (total >= 13) {
      classificacao = "TCE leve (13‚Äì15)";
    } else if (total >= 9) {
      classificacao = "TCE moderado (9‚Äì12)";
    } else {
      classificacao = "TCE grave (3‚Äì8, geralmente coma)";
    }

    return { total, e, v, m, classificacao };
  }

  function atualizaGCS() {
    const ocular = document.getElementById("gcs-ocular").value;
    const verbal = document.getElementById("gcs-verbal").value;
    const motora = document.getElementById("gcs-motora").value;

    const { total, e, v, m, classificacao } = calcGCS({ocular, verbal, motora});
    const texto = `Glasgow: ${total} (E${e} V${v} M${m}) ‚Äì ${classificacao}`;
    document.getElementById("gcs-resultado").textContent = texto;
    
    // Salvar score calculado
    salvarScore("Glasgow", `${total}/15 (E${e} V${v} M${m})`, classificacao);
  }

  // ---------- TIMI Score ----------
  function calcTIMI(dados) {
    let score = 0;
    if (dados.idade) score++;
    if (dados.fatores) score++;
    if (dados.estenose) score++;
    if (dados.aspirina) score++;
    if (dados.angina) score++;
    if (dados.st) score++;
    if (dados.marcadores) score++;

    let risco;
    if (score <= 2) {
      risco = "Baixo risco (4.7% de eventos em 14 dias)";
    } else if (score <= 4) {
      risco = "Risco intermedi√°rio (19.9% de eventos em 14 dias)";
    } else {
      risco = "Alto risco (41% de eventos em 14 dias)";
    }

    return { score, risco };
  }

  function atualizaTIMI() {
    const dados = {
      idade: document.getElementById("timi-idade").checked,
      fatores: document.getElementById("timi-fatores").checked,
      estenose: document.getElementById("timi-estenose").checked,
      aspirina: document.getElementById("timi-aspirina").checked,
      angina: document.getElementById("timi-angina").checked,
      st: document.getElementById("timi-st").checked,
      marcadores: document.getElementById("timi-marcadores").checked
    };

    const { score, risco } = calcTIMI(dados);
    const texto = `TIMI Score: ${score}/7 ‚Äì ${risco}`;
    document.getElementById("timi-resultado").textContent = texto;
    
    // Salvar score calculado
    salvarScore("TIMI", `${score}/7`, risco);
  }

  // ---------- SOFA Score ----------
  function calcSOFA(dados) {
    const resp = Number(dados.resp);
    const plaq = Number(dados.plaq);
    const bili = Number(dados.bili);
    const cv = Number(dados.cv);
    const neuro = Number(dados.neuro);
    const renal = Number(dados.renal);
    
    const total = resp + plaq + bili + cv + neuro + renal;

    let interpretacao;
    if (total < 2) {
      interpretacao = "Baixo risco de mortalidade (<10%)";
    } else if (total <= 5) {
      interpretacao = "Risco intermedi√°rio de mortalidade (15-20%)";
    } else if (total <= 10) {
      interpretacao = "Alto risco de mortalidade (40-50%)";
    } else {
      interpretacao = "Risco muito alto de mortalidade (>80%)";
    }

    return { total, interpretacao };
  }

  function atualizaSOFA() {
    const dados = {
      resp: document.getElementById("sofa-resp").value,
      plaq: document.getElementById("sofa-plaq").value,
      bili: document.getElementById("sofa-bili").value,
      cv: document.getElementById("sofa-cv").value,
      neuro: document.getElementById("sofa-neuro").value,
      renal: document.getElementById("sofa-renal").value
    };

    const { total, interpretacao } = calcSOFA(dados);
    const texto = `SOFA Score: ${total}/24 ‚Äì ${interpretacao}`;
    document.getElementById("sofa-resultado").textContent = texto;
    
    // Salvar score calculado
    salvarScore("SOFA", `${total}/24`, interpretacao);
  }

  // ---------- Wells Score (TVP) ----------
  function calcWells(dados) {
    let score = 0;
    if (dados.cancer) score += 1;
    if (dados.paralisia) score += 1;
    if (dados.leito) score += 1;
    if (dados.dor) score += 1;
    if (dados.edema) score += 1;
    if (dados.panturrilha) score += 1;
    if (dados.cacifo) score += 1;
    if (dados.veias) score += 1;
    if (dados.tvpPrevia) score += 1;
    if (dados.alternativo) score -= 2;

    let probabilidade;
    if (score <= 0) {
      probabilidade = "Baixa probabilidade (3% de TVP)";
    } else if (score <= 2) {
      probabilidade = "Probabilidade moderada (17% de TVP)";
    } else {
      probabilidade = "Alta probabilidade (75% de TVP)";
    }

    return { score, probabilidade };
  }

  function atualizaWells() {
    const dados = {
      cancer: document.getElementById("wells-cancer").checked,
      paralisia: document.getElementById("wells-paralisia").checked,
      leito: document.getElementById("wells-leito").checked,
      dor: document.getElementById("wells-dor").checked,
      edema: document.getElementById("wells-edema").checked,
      panturrilha: document.getElementById("wells-panturrilha").checked,
      cacifo: document.getElementById("wells-cacifo").checked,
      veias: document.getElementById("wells-veias").checked,
      tvpPrevia: document.getElementById("wells-tvp-previa").checked,
      alternativo: document.getElementById("wells-alternativo").checked
    };

    const { score, probabilidade } = calcWells(dados);
    const texto = `Wells Score: ${score} pontos ‚Äì ${probabilidade}`;
    document.getElementById("wells-resultado").textContent = texto;
    
    // Salvar score calculado
    salvarScore("Wells (TVP)", `${score} pontos`, probabilidade);
  }

  // ---------- CHA2DS2-VASc Score ----------
  function calcCHA2DS2VASc(dados) {
    let score = 0;
    if (dados.chf) score += 1;
    if (dados.has) score += 1;
    if (dados.idade75) score += 2;
    if (dados.dm) score += 1;
    if (dados.avc) score += 2;
    if (dados.vasc) score += 1;
    if (dados.idade65) score += 1;
    if (dados.sexo) score += 1;

    let recomendacao;
    if (score === 0) {
      recomendacao = "Baixo risco - Sem anticoagula√ß√£o (ou considerar)";
    } else if (score === 1) {
      recomendacao = "Baixo-intermedi√°rio - Considerar anticoagula√ß√£o (prefer√≠vel se homem)";
    } else {
      recomendacao = "Alto risco - Anticoagula√ß√£o recomendada";
    }

    return { score, recomendacao };
  }

  function atualizaCHA2DS2VASc() {
    const dados = {
      chf: document.getElementById("cha2-chf").checked,
      has: document.getElementById("cha2-has").checked,
      idade75: document.getElementById("cha2-idade75").checked,
      dm: document.getElementById("cha2-dm").checked,
      avc: document.getElementById("cha2-avc").checked,
      vasc: document.getElementById("cha2-vasc").checked,
      idade65: document.getElementById("cha2-idade65").checked,
      sexo: document.getElementById("cha2-sexo").checked
    };

    const { score, recomendacao } = calcCHA2DS2VASc(dados);
    const texto = `CHA2DS2-VASc: ${score} pontos ‚Äì ${recomendacao}`;
    document.getElementById("cha2-resultado").textContent = texto;
    
    // Salvar score calculado
    salvarScore("CHA2DS2-VASc", `${score}/9`, recomendacao);
  }

  // ---------- HAS-BLED Score ----------
  function calcHASBLED(dados) {
    let score = 0;
    if (dados.has) score += 1;
    if (dados.renal) score += 1;
    if (dados.hepat) score += 1;
    if (dados.avc) score += 1;
    if (dados.sangra) score += 1;
    if (dados.inr) score += 1;
    if (dados.idade) score += 1;
    if (dados.drogas) score += 1;

    let risco;
    if (score <= 2) {
      risco = "Baixo risco de sangramento (1.13% ao ano)";
    } else if (score === 3) {
      risco = "Risco intermedi√°rio (3.74% ao ano) - Cautela";
    } else {
      risco = "Alto risco (8.7% ao ano) - Considerar benef√≠cio/risco";
    }

    return { score, risco };
  }

  function atualizaHASBLED() {
    const dados = {
      has: document.getElementById("hasbled-has").checked,
      renal: document.getElementById("hasbled-renal").checked,
      hepat: document.getElementById("hasbled-hepat").checked,
      avc: document.getElementById("hasbled-avc").checked,
      sangra: document.getElementById("hasbled-sangra").checked,
      inr: document.getElementById("hasbled-inr").checked,
      idade: document.getElementById("hasbled-idade").checked,
      drogas: document.getElementById("hasbled-drogas").checked
    };

    const { score, risco } = calcHASBLED(dados);
    const texto = `HAS-BLED: ${score} pontos ‚Äì ${risco}`;
    document.getElementById("hasbled-resultado").textContent = texto;
    
    // Salvar score calculado
    salvarScore("HAS-BLED", `${score}/9`, risco);
  }

  </script>
    <!-- MODAL DE ESPECIALIDADES -->
  <div id="modalEspecialidades" class="modal-especialidades">
    <div class="modal-content-esp">
      <h2>üè• Selecione a Especialidade</h2>
      <div class="especialidade-item" onclick="selecionarEspecialidade('gastro')">
        üî• Gastroenterologia
      </div>
      <div class="especialidade-item" onclick="selecionarEspecialidade('psiq')">
        üß† Psiquiatria
      </div>
      <div class="especialidade-item" onclick="alert('Em breve!')">
        ‚ù§Ô∏è Cardiologia (Em breve)
      </div>
      <div class="especialidade-item" onclick="alert('Em breve!')">
        ü´Å Pneumologia (Em breve)
      </div>
      <div class="especialidade-item" onclick="alert('Em breve!')">
        üß† Neurologia (Em breve)
      </div>
      <button class="btn-fechar-modal" onclick="fecharModalEspecialidades()">Fechar</button>
    </div>
  </div>
</body>
</html>
